import{i as ee,D,T as te,c as p,t as x,d as ie,e as re,f as ne,S as se,g as F,h as oe,j as le,E as ae,k as Z,I as he,m as ce,R as ue}from"./map-b246e7d0.js";import{a as g,g as de,c as Y,b as ge,d as j,e as G,h as S,i as fe,j as v,M as _e,k as me,l as Te,m as E,n as xe,o as Fe,p as Ce,q as pe}from"./proj-cfc8763a.js";import{tileserver_hostname as K}from"./constants-b9e7c6db.js";import"./main-6ddec44d.js";class ye{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return g(i!==void 0,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return g(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){if(this.containsKey(e))return this.entries_[e].value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){g(!(e in this.entries_),16);const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}const Ee=ye;function b(o,e,t,i){return i!==void 0?(i[0]=o,i[1]=e,i[2]=t,i):[o,e,t]}function A(o,e,t){return o+"/"+e+"/"+t}function q(o){return A(o[0],o[1],o[2])}function Se(o){return o.split("/").map(Number)}function Re(o){return(o[1]<<o[0])+o[2]}function we(o,e){const t=o[0],i=o[1],r=o[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const n=e.getFullTileRange(t);return n?n.containsXY(i,r):!0}class Pe extends Ee{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const e=this.peekFirstKey(),i=Se(e)[0];this.forEach(r=>{r.tileCoord[0]!==i&&(this.remove(q(r.tileCoord)),r.release())})}}const $=Pe,M={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},y=[0,0,0],m=5;class ze{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,g(ee(this.resolutions_,function(r,n){return n-r},!0),17);let t;if(!e.origins){for(let r=0,n=this.resolutions_.length-1;r<n;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,g(this.origins_.length==this.resolutions_.length,20));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=de(i)),g(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,g(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:D,g(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(r,n){const s=new te(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,n);s.minX=Math.max(l.minX,s.minX),s.maxX=Math.min(l.maxX,s.maxX),s.minY=Math.max(l.minY,s.minY),s.maxY=Math.min(l.maxY,s.maxY)}return s},this):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let n=r.minX,s=r.maxX;n<=s;++n)for(let l=r.minY,h=r.maxY;l<=h;++l)i([t,n,l])}forEachTileCoordParentTileRange(e,t,i,r){let n,s,l,h=null,a=e[0]-1;for(this.zoomFactor_===2?(s=e[1],l=e[2]):h=this.getTileCoordExtent(e,r);a>=this.minZoom;){if(this.zoomFactor_===2?(s=Math.floor(s/2),l=Math.floor(l/2),n=p(s,s,l,l,i)):n=this.getTileRangeForExtentAndZ(h,a,i),t(a,n))return!0;--a}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const n=e[1]*2,s=e[2]*2;return p(n,n+1,s,s+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],n=e[1],s=e[2];if(t===r)return p(n,s,n,s,i);if(this.zoomFactor_){const h=Math.pow(this.zoomFactor_,t-r),a=Math.floor(n*h),c=Math.floor(s*h);if(t<r)return p(a,a,c,c,i);const u=Math.floor(h*(n+1))-1,f=Math.floor(h*(s+1))-1;return p(a,u,c,f,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,y);const r=y[1],n=y[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,y);const s=y[1],l=y[2];return p(r,s,n,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=x(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),n=x(this.getTileSize(e[0]),this.tmpSize_),s=i[0]+e[1]*n[0]*r,l=i[1]-(e[2]+1)*n[1]*r,h=s+n[0]*r,a=l+n[1]*r;return Y(s,l,h,a,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,n){const s=this.getZForResolution(i),l=i/this.getResolution(s),h=this.getOrigin(s),a=x(this.getTileSize(s),this.tmpSize_);let c=l*(e-h[0])/i/a[0],u=l*(h[1]-t)/i/a[1];return r?(c=j(c,m)-1,u=j(u,m)-1):(c=G(c,m),u=G(u,m)),b(s,c,u,n)}getTileCoordForXYAndZ_(e,t,i,r,n){const s=this.getOrigin(i),l=this.getResolution(i),h=x(this.getTileSize(i),this.tmpSize_);let a=(e-s[0])/l/h[0],c=(s[1]-t)/l/h[1];return r?(a=j(a,m)-1,c=j(c,m)-1):(a=G(a,m),c=G(c,m)),b(i,a,c,n)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=ie(this.resolutions_,e,t||0);return ge(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return re(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}const W=ze;function N(o){let e=o.getDefaultTileGrid();return e||(e=Ae(o),o.setDefaultTileGrid(e)),e}function je(o,e,t){const i=e[0],r=o.getTileCoordCenter(e),n=X(t);if(!Te(n,r)){const s=v(n),l=Math.ceil((n[0]-r[0])/s);return r[0]+=s*l,o.getTileCoordForCoordAndZ(r,i)}return e}function Ge(o,e,t,i){i=i!==void 0?i:"top-left";const r=H(o,e,t);return new W({extent:o,origin:me(o,i),resolutions:r,tileSize:t})}function Ze(o){const e=o||{},t=e.extent||S("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:H(t,e.maxZoom,e.tileSize,e.maxResolution)};return new W(i)}function H(o,e,t,i){e=e!==void 0?e:ne,t=x(t!==void 0?t:D);const r=fe(o),n=v(o);i=i>0?i:Math.max(n/t[0],r/t[1]);const s=e+1,l=new Array(s);for(let h=0;h<s;++h)l[h]=i/Math.pow(2,h);return l}function Ae(o,e,t,i){const r=X(o);return Ge(r,e,t,i)}function X(o){o=S(o);let e=o.getExtent();if(!e){const t=180*_e.degrees/o.getMetersPerUnit();e=Y(-t,-t,t,t)}return e}class Le extends se{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.opaque_=e.opaque!==void 0?e.opaque:!1,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&x(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tileCache=new $(e.cacheSize||0),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)}forEachLoadedTile(e,t,i,r){const n=this.getTileCacheForProjection(e);if(!n)return!1;let s=!0,l,h,a;for(let c=i.minX;c<=i.maxX;++c)for(let u=i.minY;u<=i.maxY;++u)h=A(t,c,u),a=!1,n.containsKey(h)&&(l=n.get(h),a=l.getState()===F.LOADED,a&&(a=r(l)!==!1)),a||(s=!1);return s}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getOpaque(e){return this.opaque_}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,n){return oe()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:N(e)}getTileCacheForProjection(e){const t=this.getProjection();return g(t===null||E(t,e),68),this.tileCache}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),n=this.getTilePixelRatio(t),s=x(r.getTileSize(e),this.tmpSize);return n==1?s:le(s,n,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=je(i,e,t)),we(e,i)?e:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(e,t){const i=this.getTileCacheForProjection(t);e>i.highWaterMark&&(i.highWaterMark=e)}useTile(e,t,i,r){}}class Ue extends ae{constructor(e,t){super(e),this.tile=t}}const Me=Le;function be(o,e){const t=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,n=/\{-y\}/g;return function(s,l,h){if(s)return o.replace(t,s[0].toString()).replace(i,s[1].toString()).replace(r,s[2].toString()).replace(n,function(){const a=s[0],c=e.getFullTileRange(a);return g(c,55),(c.getHeight()-s[2]-1).toString()})}}function Xe(o,e){const t=o.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=be(o[r],e);return V(i)}function V(o){return o.length===1?o[0]:function(e,t,i){if(!e)return;const r=Re(e),n=xe(r,o.length);return o[n](e,t,i)}}function ke(o){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(o);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let n;for(n=i;n<=r;++n)e.push(o.replace(t[0],String.fromCharCode(n)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(o),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(o.replace(t[0],r.toString()));return e}return e.push(o),e}class k extends Me{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===k.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=Z(t),r=t.getState();let n;r==F.LOADING?(this.tileLoadingKeys_[i]=!0,n=M.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],n=r==F.ERROR?M.TILELOADERROR:r==F.LOADED?M.TILELOADEND:void 0),n!=null&&this.dispatchEvent(new Ue(n,t))}setTileLoadFunction(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=ke(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Xe(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}useTile(e,t,i){const r=A(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const Oe=k;class Ie extends Oe{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Ke,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:he,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const r in this.tileCacheForProjection){const n=this.tileCacheForProjection[r];n.expireCache(n==i?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!E(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!E(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||E(t,e)))return this.tileGrid;const i=Z(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=N(e)),this.tileGridForProjection[i]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||E(t,e))return this.tileCache;const i=Z(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new $(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(e,t,i,r,n,s){const l=[e,t,i],h=this.getTileCoordForTileUrlFunction(l,n),a=h?this.tileUrlFunction(h,r,n):void 0,c=new this.tileClass(l,a!==void 0?F.IDLE:F.EMPTY,a!==void 0?a:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=s,c.addEventListener(ce.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,i,r,n){const s=this.getProjection();if(!s||!n||E(s,n))return this.getTileInternal(e,t,i,r,s||n);const l=this.getTileCacheForProjection(n),h=[e,t,i];let a;const c=q(h);l.containsKey(c)&&(a=l.get(c));const u=this.getKey();if(a&&a.key==u)return a;const f=this.getTileGridForProjection(s),T=this.getTileGridForProjection(n),_=this.getTileCoordForTileUrlFunction(h,n),d=new ue(s,f,n,T,h,_,this.getTilePixelRatio(r),this.getGutter(),(R,C,w,P)=>this.getTileInternal(R,C,w,P,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return d.key=u,a?(d.interimTile=a,d.refreshInterimChain(),l.replace(c,d)):l.set(c,d),d}getTileInternal(e,t,i,r,n){let s=null;const l=A(e,t,i),h=this.getKey();if(!this.tileCache.containsKey(l))s=this.createTile_(e,t,i,r,n,h),this.tileCache.set(l,s);else if(s=this.tileCache.get(l),s.key!=h){const a=s;s=this.createTile_(e,t,i,r,n,h),a.getState()==F.IDLE?s.interimTile=a.interimTile:s.interimTile=a,s.refreshInterimChain(),this.tileCache.replace(l,s)}return s}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const i=S(e);if(i){const r=Z(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function Ke(o,e){o.getImage().src=e}const De=Ie;function Ye(o){const e=o[0],t=new Array(e);let i=1<<e-1,r=null,n=null;for(n=0;n<e;++n)r=48,o[1]&i&&(r=r+1),o[2]&i&&(r=r+2),t[n]=String.fromCharCode(r),i=i>>1;return t.join("")}const ve='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>';class He extends De{constructor(e){const t=e.hidpi!==void 0?e.hidpi:!1;super({cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,opaque:!0,projection:S("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:function(r,n){const[s,l,h,a]=n.replace("https://","").split(/[/?]+/);n=`https://${K}/${l}/${h}?${a}`,r.src_=n,r.getImage().src=n},tilePixelRatio:t?2:1,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.hidpi_=t,this.culture_=e.culture!==void 0?e.culture:"en-us",this.maxZoom_=e.maxZoom!==void 0?e.maxZoom:-1,this.imagerySet_="Aerial";let i=null;i=`https://${K}/REST/v1/Imagery/Metadata/${this.imagerySet_}?uriScheme=https&include=ImageryProviders&c=${this.culture_}`,fetch(i).then(r=>r.json()).then(r=>this.handleImageryMetadataResponse(r))}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(e){if(e.statusCode!==200||e.statusDescription!=="OK"||e.authenticationResultCode!=="ValidCredentials"||e.resourceSets.length!==1||e.resourceSets[0].resources.length!==1){this.setState("error");return}const t=e.resourceSets[0].resources[0],i=this.maxZoom_===-1?t.zoomMax:this.maxZoom_,r=this.getProjection(),n=X(r),s=this.hidpi_?2:1,l=t.imageWidth===t.imageHeight?t.imageWidth/s:[t.imageWidth/s,t.imageHeight/s],h=Ze({extent:n,minZoom:t.zoomMin,maxZoom:i,tileSize:l});this.tileGrid=h;const a=this.culture_,c=this.hidpi_;if(this.tileUrlFunction=V(t.imageUrlSubdomains.map(u=>{const f=[0,0,0],T=t.imageUrl.replace("{subdomain}",u).replace("{culture}",a);return function(_,d,R){if(!_)return;b(_[0],_[1],_[2],f);let C=T;return c&&(C=`${C}&dpi=d1&device=mobile`),C.replace("{quadkey}",Ye(f))}})),t.imageryProviders){const u=Fe(S("EPSG:4326"),this.getProjection());this.setAttributions(f=>{const T=[],_=f.viewState,d=this.getTileGrid(),R=d.getZForResolution(_.resolution,this.zDirection),w=d.getTileCoordForCoordAndZ(_.center,R)[0];return t.imageryProviders.map(P=>{let O=!1;const I=P.coverageAreas;for(let L=0,B=I.length;L<B;++L){const U=I[L];if(w>=U.zoomMin&&w<=U.zoomMax){const z=U.bbox,J=[z[1],z[0],z[3],z[2]],Q=Ce(J,u);if(pe(Q,f.extent)){O=!0;break}}}O&&T.push(P.attribution)}),T.push(ve),T})}this.setState("ready")}}export{He as CustomBingMaps};
