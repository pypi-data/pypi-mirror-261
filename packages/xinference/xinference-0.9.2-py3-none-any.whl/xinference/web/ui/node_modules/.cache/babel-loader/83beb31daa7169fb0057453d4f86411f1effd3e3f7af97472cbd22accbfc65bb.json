{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,FormControl,TextField}from'@mui/material';import React,{useContext,useEffect,useState}from'react';import{ApiContext}from'../../components/apiContext';import fetcher from'../../components/fetcher';import ImageCard from'./imageCard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LaunchImage=function LaunchImage(){var endPoint=useContext(ApiContext).endPoint;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),registrationData=_useState2[0],setRegistrationData=_useState2[1];var _useContext=useContext(ApiContext),isCallingApi=_useContext.isCallingApi,setIsCallingApi=_useContext.setIsCallingApi;var _useContext2=useContext(ApiContext),isUpdatingModel=_useContext2.isUpdatingModel;// States used for filtering\nvar _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var handleChange=function handleChange(event){setSearchTerm(event.target.value);};var filter=function filter(registration){if(!registration||typeof searchTerm!=='string')return false;var modelName=registration.model_name?registration.model_name.toLowerCase():'';return modelName.includes(searchTerm.toLowerCase());};var update=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,registrations,newRegistrationData,builtinImageModels;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(isCallingApi||isUpdatingModel)){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:_context2.prev=2;setIsCallingApi(true);_context2.next=6;return fetcher(\"\".concat(endPoint,\"/v1/model_registrations/image?detailed=true\"),{method:'GET'});case 6:response=_context2.sent;_context2.next=9;return response.json();case 9:registrations=_context2.sent;_context2.next=12;return Promise.all(registrations.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(registration){var desc;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetcher(\"\".concat(endPoint,\"/v1/model_registrations/image/\").concat(registration.model_name),{method:'GET'});case 2:desc=_context.sent;_context.t0=_objectSpread;_context.t1=_objectSpread;_context.t2={};_context.next=8;return desc.json();case 8:_context.t3=_context.sent;_context.t4=(0,_context.t1)(_context.t2,_context.t3);_context.t5={};_context.t6={is_builtin:registration.is_builtin,is_cached:registration.cache_status};return _context.abrupt(\"return\",(0,_context.t0)(_context.t4,_context.t5,_context.t6));case 13:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()));case 12:newRegistrationData=_context2.sent;builtinImageModels=newRegistrationData.filter(function(v){return v.is_builtin;});setRegistrationData(builtinImageModels);_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](2);console.error('Error:',_context2.t0);case 20:_context2.prev=20;setIsCallingApi(false);return _context2.finish(20);case 23:case\"end\":return _context2.stop();}},_callee2,null,[[2,17,20,23]]);}));return function update(){return _ref.apply(this,arguments);};}();useEffect(function(){update();// eslint-disable-next-line\n},[]);var style={display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(300px, 1fr))',paddingLeft:'2rem',gridGap:'2rem 0rem'};return/*#__PURE__*/_jsxs(Box,{m:\"20px\",children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr',margin:'30px 2rem'},children:/*#__PURE__*/_jsx(FormControl,{variant:\"outlined\",margin:\"normal\",children:/*#__PURE__*/_jsx(TextField,{id:\"search\",type:\"search\",label:\"Search for image model name\",value:searchTerm,onChange:handleChange,size:\"small\"})})}),/*#__PURE__*/_jsx(\"div\",{style:style,children:registrationData.filter(function(registration){return filter(registration);}).map(function(filteredRegistration){return/*#__PURE__*/_jsx(ImageCard,{url:endPoint,modelData:filteredRegistration});})})]});};export default LaunchImage;","map":{"version":3,"names":["Box","FormControl","TextField","React","useContext","useEffect","useState","ApiContext","fetcher","ImageCard","jsx","_jsx","jsxs","_jsxs","LaunchImage","endPoint","_useState","_useState2","_slicedToArray","registrationData","setRegistrationData","_useContext","isCallingApi","setIsCallingApi","_useContext2","isUpdatingModel","_useState3","_useState4","searchTerm","setSearchTerm","handleChange","event","target","value","filter","registration","modelName","model_name","toLowerCase","includes","update","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","response","registrations","newRegistrationData","builtinImageModels","wrap","_callee2$","_context2","prev","next","abrupt","concat","method","sent","json","Promise","all","map","_ref2","_callee","desc","_callee$","_context","t0","_objectSpread","t1","t2","t3","t4","t5","t6","is_builtin","is_cached","cache_status","stop","_x","apply","arguments","v","console","error","finish","style","display","gridTemplateColumns","paddingLeft","gridGap","m","children","margin","variant","id","type","label","onChange","size","filteredRegistration","url","modelData"],"sources":["/home/runner/work/inference/inference/xinference/web/ui/src/scenes/launch_model/launchImage.js"],"sourcesContent":["import { Box, FormControl, TextField } from '@mui/material'\nimport React, { useContext, useEffect, useState } from 'react'\n\nimport { ApiContext } from '../../components/apiContext'\nimport fetcher from '../../components/fetcher'\nimport ImageCard from './imageCard'\n\nconst LaunchImage = () => {\n  let endPoint = useContext(ApiContext).endPoint\n  const [registrationData, setRegistrationData] = useState([])\n  const { isCallingApi, setIsCallingApi } = useContext(ApiContext)\n  const { isUpdatingModel } = useContext(ApiContext)\n\n  // States used for filtering\n  const [searchTerm, setSearchTerm] = useState('')\n\n  const handleChange = (event) => {\n    setSearchTerm(event.target.value)\n  }\n\n  const filter = (registration) => {\n    if (!registration || typeof searchTerm !== 'string') return false\n    const modelName = registration.model_name\n      ? registration.model_name.toLowerCase()\n      : ''\n    return modelName.includes(searchTerm.toLowerCase())\n  }\n\n  const update = async () => {\n    if (isCallingApi || isUpdatingModel) return\n\n    try {\n      setIsCallingApi(true)\n\n      const response = await fetcher(\n        `${endPoint}/v1/model_registrations/image?detailed=true`,\n        {\n          method: 'GET',\n        }\n      )\n\n      const registrations = await response.json()\n      const newRegistrationData = await Promise.all(\n        registrations.map(async (registration) => {\n          const desc = await fetcher(\n            `${endPoint}/v1/model_registrations/image/${registration.model_name}`,\n            {\n              method: 'GET',\n            }\n          )\n\n          return {\n            ...(await desc.json()),\n            is_builtin: registration.is_builtin,\n            is_cached: registration.cache_status,\n          }\n        })\n      )\n\n      const builtinImageModels = newRegistrationData.filter((v) => {\n        return v.is_builtin\n      })\n      setRegistrationData(builtinImageModels)\n    } catch (error) {\n      console.error('Error:', error)\n    } finally {\n      setIsCallingApi(false)\n    }\n  }\n\n  useEffect(() => {\n    update()\n    // eslint-disable-next-line\n  }, [])\n\n  const style = {\n    display: 'grid',\n    gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',\n    paddingLeft: '2rem',\n    gridGap: '2rem 0rem',\n  }\n\n  return (\n    <Box m=\"20px\">\n      <div\n        style={{\n          display: 'grid',\n          gridTemplateColumns: '1fr',\n          margin: '30px 2rem',\n        }}\n      >\n        <FormControl variant=\"outlined\" margin=\"normal\">\n          <TextField\n            id=\"search\"\n            type=\"search\"\n            label=\"Search for image model name\"\n            value={searchTerm}\n            onChange={handleChange}\n            size=\"small\"\n          />\n        </FormControl>\n      </div>\n      <div style={style}>\n        {registrationData\n          .filter((registration) => filter(registration))\n          .map((filteredRegistration) => (\n            <ImageCard url={endPoint} modelData={filteredRegistration} />\n          ))}\n      </div>\n    </Box>\n  )\n}\n\nexport default LaunchImage\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}