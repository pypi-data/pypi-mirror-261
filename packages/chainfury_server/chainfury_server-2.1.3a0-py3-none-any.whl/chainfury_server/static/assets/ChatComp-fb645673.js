import{r as i,I as H,ac as k,ad as O,L as E,b as r,j as s,Q as T}from"./index-cb6c03f9.js";import{m as I}from"./index-10efa1c9.js";const P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAADrklEQVR4nO3ZW4ydUxQH8I1WK1Va4cU1k6pLSkIj4UFKPGk8SCvVUYk3SUWFCHGLCE9IXcoTwQsRDaJJXeoaEkHdBq1BkCalioigF0r4yc5ZJ/kyvm/OmZnvnPkq809OMjNr77X+e/Ze66z93ylNYQpT6AtwFC7EnXgaQ/gaP8Qn//xh2O7AMhyZmgAci9uwSTV+iU8VPsGt2VeahAUswgb8HWT+wfu4B4M4FXNK5s3BQlyEe2OH2si+XsCZ/dqB5wvBv8Q1OHoCPo/Btfiq4PdZzKuXfSvYPrgauyPQp1iS/15jjH1xAYYjxi5cWVsMHIinCs7zgvarxXl5vGmxQ+1/2pOZw0SdHoKNhV04vjbGnWOfiM8i9juYO15HB0UJzXgJs2tn25nDbLwSHD4YM4d8dKKCtBNvRs/YduYys8DluTEda9wcE3NJndVTpt3n6VBwuqHbSafgT/yKgdQQYB5+wx6c3M2E9pm8NDUMuKyds50Gnh0DP+5liR0vtHJ3c3BcNNrA3NBlLE8NBVYEx7VVAw6O3NiO6amhwP7RTe8pLcfRVmc8mBoOPBxcl5YZ7w7jstRwYHlwXV1mfDmMx6WGAycE1xfLjO2+pmN+4Dx8i2+wuF/jRuRJxnCZ8TvsTF0gAraxtV/jiohOfFuZIf9Hdqf/wUI2haOZXThZHMG34tx+jev2aLWTfX5qOLTuKpXJfnsYV6SGQ0vgqCy/+Q6e8UBqOPBIcF1SZpyFHfgpn8HUUGAGfsQflTdGPBYrHUwNBS4Ojk+MNmhhiG3DDW3jp4UIoqOQh2di4OWpYcCq4Lahm8EDkSu7mtR3YX7uPKJ9X9DtpJWx8s1lGm6/oSVN5VtrxnVjnfxQTHxjMpUUHBC6Wsb6LK2O1cH0gp6Ulb5De8Z29J14LTi8N27pNGp2+x6f1fLTa2dbHXsBPo/Yb0/4iIdysTrK8l+4qTa21SX2evwei1g7YRF7RIDzw/H3tTn977PCIL6IOLlCrepFoMMjwJs1+x2IHdhSuJOs65nKWdCT1lTYb8RduCRk17kjH2nimeK0aDPuw0cjnt7W44yeLKBAIivhGeeUnOk1qrEjdOQqZHH6lr7ozDgiEn1LsY7nhx+8HoS2xyNnPiaPR6XJPdu2nFfxPP1uvEDlu8/SfFx7Tr4I3B9kV8bvh4UOlpVJQbhvr1njAk4Kwjvj/XBd9DttPFpreewF4jvkrZJznb9TXsVZaW8ArsDPoXAMxfm+am8QKKaQJhn/Alh2rBucIzJ9AAAAAElFTkSuQmCC",j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVR4nO2YQQ6CMBBFex85joaF3oMlLr2zJo9IbEhETIGZdkrm7djw/2uBTgjBcRzHcRIBTqHWDOAOvICbSkAYMy7AE3holI+oSDCVj8hIAM3XjflctyIBYcxoFzIaqYDzjwCRnWC+8vHeV5HymhLkKq8hkb28pESx8hISxcvvkTBTfouEufJrJMyWT5EwXz7hNFU9xXPshO2VXyFhv/ybhWd+9mLXVt6+BDW/xPz5VGqO4iKkfOfNSrDikDInwYYT1owEO8aD4hIIzDbFJBAczLJLoDBVkktCcyRGW+IoP7Y66ZVP2IleOqDTHomZJHqtgHp/rzuO4ziHZAAWx4+4dpF6rAAAAABJRU5ErkJggg==",X=({chatId:o})=>{const[d,l]=i.useState(!1),[t,c]=i.useState([]),[n,u]=i.useState(""),[g,f]=i.useState(!1),{chat_id:p}=H(),[y]=k(),[b,w]=i.useState([]),[m,A]=i.useState(!1),[S]=O(),[C,N]=i.useState(null),h=E();i.useEffect(()=>{o&&(c([]),w([]),N(I(30)),l(!1))},[o]),i.useEffect(()=>{console.log("location changed",h.hash),h.hash==="#open"?l(!0):l(!1)},[h]),i.useEffect(()=>{n!=null&&n.trim()&&B()},[t]);const B=async()=>{A(!1),f(!0),y({chatbot_id:o??p??"",new_message:n,chat_history:b,session_id:C??""}).unwrap().then(e=>{c([...t,{id:e==null?void 0:e.prompt_id,message:e==null?void 0:e.result,isSender:!1}]),A(!0)}).catch(e=>{var a,v;(a=e==null?void 0:e.data)!=null&&a.detail&&c([...t,{id:t.length+1,message:(v=e==null?void 0:e.data)==null?void 0:v.detail,isSender:!1}])}).finally(()=>{const e=document.querySelector(".chatContainer");e&&(e.scrollTop=e.scrollHeight-300),w([...b,n]),f(!1)}),u("")},x=(e,a)=>{S({prompt_id:a,score:e}).finally(()=>{A(!1)})};return r("div",{className:`absolute z-[100000] right-0 bottom-0 pt-[8px] px-[4px] ${p?"w-screen":""} overflow-hidden`,children:[s("div",{className:`flex flex-col ${d&&!o?p?"w-[98vw]":"w-[1000px]":""} ${o?"max-h-[800px]":"max-h-screen"} ${d?"border shadow-md overflow-hidden mr-[4px]":""} border-light-neutral-grey-200 rounded-md  regular250 `,children:d?r(T,{children:[r("div",{className:"overflow-scroll  bg-light-system-bg-primary h-[800px] min-w-[1000px] p-[16px] pb-[40px] chatContainer",children:[s("div",{className:"chat nbx-chat-start",children:s("div",{className:"flex flex-col ",children:s("div",{className:"chat-bubble",children:"Hi there! How can I help?"})})}),t.map((e,a)=>s("div",{className:`chat ${e.isSender?"nbx-chat-end":"nbx-chat-start"}`,children:r("div",{className:`flex flex-col ${!(e!=null&&e.isSender)&&m?"rounded-b-[8px!important] overflow-hidden":""}`,children:[s("div",{className:`chat-bubble ${!(e!=null&&e.isSender)&&m?"rounded-br-[0px!important]":""}`,children:e.message}),!(e!=null&&e.isSender)&&m&&a===(t==null?void 0:t.length)-1?r("div",{className:"bg-light-neutral-grey-300 p-[8px] flex gap-[8px] text-light-neutral-grey-900 items-center",children:[s("span",{children:"Rate this answer:"}),s("span",{onClick:()=>{x(3,e.id.toString())},className:"text-[20px] cursor-pointer",children:"ðŸ˜€"}),s("span",{onClick:()=>{x(2,e.id.toString())},className:"text-[20px] cursor-pointer",children:"ðŸ˜"}),s("span",{onClick:()=>{x(1,e.id.toString())},className:"text-[20px] cursor-pointer",children:"ðŸ˜ž"})]}):""]})},a))]}),s("div",{className:"p-[8px] bg-light-system-bg-primary ",children:s("input",{value:g?"Thinking...":n,disabled:g,onChange:e=>{u(e.target.value)},onKeyPress:e=>{e.key==="Enter"&&(n!=null&&n.trim())&&c([...t,{id:t.length+1,message:n,isSender:!0}])},type:"text",placeholder:"Write your message!",className:"w-full focus:outline-none pl bg-light-system-bg-secondary rounded-md py-3"})})]}):s("div",{className:"flex justify-end",children:s("div",{onClick:()=>{l(!0)},className:"w-fit rounded-full m-[8px] border-0 cursor-pointer p-[8px] bg-light-primary-blue-400",children:s("img",{src:P,alt:"chat_box",className:"w-[30px] h-[30px]"})})})}),s("div",{className:"flex justify-end",children:d?s("div",{onClick:()=>{l(!1)},className:"w-fit rounded-full m-[8px] border-0 cursor-pointer p-[8px] bg-light-critical-red-600",children:s("img",{src:j,alt:"chat_box",className:"w-[30px] h-[30px]"})}):""})]})};export{X as default};
