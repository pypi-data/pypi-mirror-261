{"version":3,"file":"lib_index_js.67179098403118486ca2.js","mappings":";;;;;;;;;;;;;AAAA,iEAAe,oYAAoY,8DAA8D,cAAc,SAAS,cAAc,spCAAspC;;;;;;;;;;;;;;ACA5oD,iEAAe,03CAA03C;;;;;;;;;;;;;;;;;;ACAz4C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACA;AACP;AACO;AACA;AACA;;;;;;;;;;;;;;;;;;;;;ACdP;AACA;AACA;AACA;AACA;AACA;AAC2D;AACG;AACxB;AAC/B;AACP,kCAAkC,+CAAQ;AAC1C,kCAAkC,+CAAQ;AAC1C,oCAAoC,+CAAQ;AAC5C,0CAA0C,+CAAQ;AAClD,gBAAgB,6CAAM;AACtB,IAAI,gDAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G,QAAQ,GAAG,sCAAsC;AAC5J;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0DAAM;AAC/B;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gDAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,0DAAmB,UAAU,mHAAmH,iBAAiB,oJAAoJ;AACjU,QAAQ,0DAAmB,UAAU,mDAAmD,qBAAqB,6BAA6B,mBAAmB;AAC7J,QAAQ,0DAAmB,aAAa,mDAAmD,qBAAqB,8EAA8E,aAAa,4CAA4C;AACvP,QAAQ,0DAAmB,aAAa,iDAAiD,mBAAmB,8EAA8E,mEAAe,aAAa,wCAAwC;AAC9P;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAe,CAAC,0DAAmB;AACvC;;;;;;;;;;;;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AAC8C;AACP;AACU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,wDAAM;AAC/B;AACA;AACA,KAAK;AACL,wBAAwB,wDAAM;AAC9B;AACA;AACA,KAAK;AACL,yBAAyB,wDAAM;AAC/B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oDAAU,CAAC,0DAAkB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,iEAAiE;AACpH;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,iCAAiC,oDAAU,CAAC,0DAAkB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP;AACA;;;;;;;;;;;;;;;;;;;AC3HA;AACA;AACA;AACA;AACA;AACA;AAC+C;AACS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACO,kDAAkD;AACzD;AACA,qBAAqB,kEAAgB;AACrC,uBAAuB,yDAAM;AAC7B;AACA;AACA,qBAAqB,kEAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kEAAgB;AAClC;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCA;AACA;AACA;AACA;AACA;AACA;AAC6D;AACA;AACX;AACF;AACO;AACH;AACI;AACO;AACC;AAChE;AACA,wBAAwB,8DAAO;AAC/B;AACA,YAAY,wEAAW;AACvB,CAAC;AACD,6BAA6B,8DAAO;AACpC;AACA,YAAY,uEAAY;AACxB,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B,EAAE,KAAK,EAAE,KAAK,EAAE;AAC1C,qBAAqB,kEAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sBAAsB,sCAAsC;AAC5D;AACA;AACA;AACA,+BAA+B,mDAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,2CAA2C,SAAS;AACpD;AACA;AACA;AACA,sBAAsB,kDAAK;AAC3B;AACA;AACA,wBAAwB,2DAAsB;AAC9C,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA;AACA;AACA,IAAI,6DAAS;AACb,IAAI,6EAA2B;AAC/B;AACA;AACA,IAAI,iEAAa;AACjB;AACA;AACA;AACA;AACA;AACA,eAAe,iEAAe;AAC9B;AACA;AACA;AACA,iEAAe,MAAM,EAAC;;;;;;;;;;;;;;;;;;;;AChFtB;AACA;AACA;AACA;AACA;AACA;AACA;AACmD;AACM;AACzD;AACA;AACA,YAAY,0DAAmB;AAC/B,QAAQ,0DAAmB,aAAa,cAAc;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,0DAAmB,CAAC,2CAAQ,IAAI,yFAAyF;AACrI,QAAQ,0DAAmB,QAAQ,6FAA6F;AAChI,YAAY,0DAAmB,SAAS,UAAU;AAClD,gBAAgB,0DAAmB,CAAC,mEAAY,UAAU,iBAAiB;AAC3E,gBAAgB,0DAAmB,WAAW,8CAA8C;AAC5F,gBAAgB,0DAAmB,WAAW,8CAA8C;AAC5F;AACA;AACA;AACA;AACO,sCAAsC,4CAAS;AACtD;AACA;AACA;AACA;AACA,+DAA+D,0DAAmB,oBAAoB,gBAAgB;AACtH,gBAAgB,0DAAmB,CAAC,2CAAQ;AAC5C,YAAY,0DAAmB,mBAAmB,0BAA0B;AAC5E,YAAY,0DAAmB;AAC/B,gBAAgB,0DAAmB,SAAS,4BAA4B;AACxE;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,mDAAmD;AACnD;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AAC4D;AACrB;AACqC;AACd;AACnB;AACjB;AAC1B;AACA,YAAY,0DAAmB,CAAC,2DAAS,IAAI,kDAAkD,kBAAkB,0DAAmB,CAAC,6EAAuB,IAAI,kBAAkB;AAClL;AACO,qCAAqC,6DAAW;AACvD;AACA;AACA;AACA,2BAA2B,qDAAM;AACjC;AACA;AACA;AACA;AACA;AACA,QAAQ,oDAAU,CAAC,oDAAY;AAC/B;AACA;AACA;AACA;AACA,6FAA6F,MAAM;AACnG;AACA,SAAS;AACT,qEAAqE,MAAM;AAC3E,SAAS;AACT;AACA;AACA,QAAQ,oDAAU,CAAC,uDAAe;AAClC;AACA;AACA;AACA;AACA;AACA,0DAA0D,4DAAM,sDAAsD,iBAAiB,IAAI,mBAAmB;AAC9J,qBAAqB;AACrB;AACA;AACA;AACA,qGAAqG,SAAS;AAC9G;AACA;AACA;AACA,SAAS;AACT,yEAAyE,MAAM;AAC/E,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gBAAgB,0DAAmB,uBAAuB,kDAAkD;AAC5G;AACA","sources":["webpack://workbench_jupyterlab/./images/posit-icon-fullcolor.svg","webpack://workbench_jupyterlab/./images/posit-icon-unstyled.svg","webpack://workbench_jupyterlab/./lib/constants.js","webpack://workbench_jupyterlab/./lib/disconnectAlert.js","webpack://workbench_jupyterlab/./lib/disconnectMonitor.js","webpack://workbench_jupyterlab/./lib/handler.js","webpack://workbench_jupyterlab/./lib/index.js","webpack://workbench_jupyterlab/./lib/proxiedServersComponent.js","webpack://workbench_jupyterlab/./lib/widget.js"],"sourcesContent":["export default \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n<!-- Generator: Adobe Illustrator 26.4.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\\n<svg version=\\\"1.1\\\" id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\n\\t width=\\\"184px\\\" height=\\\"182.5px\\\" viewBox=\\\"0 0 184 182.5\\\" style=\\\"enable-background:new 0 0 184 182.5;\\\" xml:space=\\\"preserve\\\">\\n<style type=\\\"text/css\\\">\\n\\t.st0{fill:#EE6331;}\\n\\t.st1{fill:#447099;}\\n</style>\\n<g id=\\\"posit-logo\\\">\\n\\t<polygon id=\\\"fullLogo-8\\\" class=\\\"st0\\\" points=\\\"38,73.1 46.2,69.5 82.9,53.3 90.9,49.7 179.7,10.5 179.7,57.8 143.8,73.1 135.7,69.5 \\n\\t\\t173.2,53.5 173.2,20.5 98.9,53.3 90.9,56.8 54.3,73 46.2,76.6 20.3,88 20.3,96.5 45.8,107.8 53.9,111.4 91.5,128 99.5,131.5 \\n\\t\\t173.2,164.1 173.2,130.7 136.1,114.9 144.2,111.3 179.7,126.4 179.7,174 91.5,135.1 83.6,131.6 45.8,114.9 37.6,111.3 13.8,100.7 \\n\\t\\t13.8,83.8 \\t\\\"/>\\n\\t<polygon class=\\\"st0\\\" points=\\\"99.2,92.1 135.6,76.6 127.5,73 82.6,92.1 127.9,111.4 136,107.8 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-9\\\" class=\\\"st1\\\" points=\\\"45.8,107.8 53.9,111.4 90.9,95.6 82.7,92.1 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-10\\\" class=\\\"st1\\\" points=\\\"54.3,73 46.2,76.6 82.7,92.1 90.9,88.6 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-11\\\" class=\\\"st1\\\" points=\\\"143.8,73.1 135.7,69.5 98.9,53.3 90.9,49.7 2.1,10.5 2.1,57.8 38,73.1 46.2,69.5 \\n\\t\\t8.6,53.5 8.6,20.5 82.9,53.3 90.9,56.8 127.5,73 135.6,76.6 161.6,88 161.6,96.5 136.1,107.8 127.9,111.4 90.4,128 82.4,131.5 \\n\\t\\t8.6,164.1 8.6,130.7 45.8,114.9 37.6,111.3 2.1,126.4 2.1,174 90.3,135.1 98.3,131.6 136.1,114.9 144.2,111.3 168,100.7 168,83.8 \\t\\n\\t\\t\\\"/>\\n</g>\\n</svg>\\n\";","export default \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n<!-- Generator: Adobe Illustrator 26.4.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\\n<svg version=\\\"1.1\\\" id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 184 182.5\\\" xml:space=\\\"preserve\\\">\\n<g id=\\\"posit-logo\\\">\\n\\t<polygon id=\\\"fullLogo-8\\\" points=\\\"38,73.1 46.2,69.5 82.9,53.3 90.9,49.7 179.7,10.5 179.7,57.8 143.8,73.1 135.7,69.5 \\n\\t\\t173.2,53.5 173.2,20.5 98.9,53.3 90.9,56.8 54.3,73 46.2,76.6 20.3,88 20.3,96.5 45.8,107.8 53.9,111.4 91.5,128 99.5,131.5 \\n\\t\\t173.2,164.1 173.2,130.7 136.1,114.9 144.2,111.3 179.7,126.4 179.7,174 91.5,135.1 83.6,131.6 45.8,114.9 37.6,111.3 13.8,100.7 \\n\\t\\t13.8,83.8 \\t\\\"/>\\n\\t<polygon points=\\\"99.2,92.1 135.6,76.6 127.5,73 82.6,92.1 127.9,111.4 136,107.8 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-9\\\" points=\\\"45.8,107.8 53.9,111.4 90.9,95.6 82.7,92.1 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-10\\\" points=\\\"54.3,73 46.2,76.6 82.7,92.1 90.9,88.6 \\t\\\"/>\\n\\t<polygon id=\\\"fullLogo-11\\\" points=\\\"143.8,73.1 135.7,69.5 98.9,53.3 90.9,49.7 2.1,10.5 2.1,57.8 38,73.1 46.2,69.5 \\n\\t\\t8.6,53.5 8.6,20.5 82.9,53.3 90.9,56.8 127.5,73 135.6,76.6 161.6,88 161.6,96.5 136.1,107.8 127.9,111.4 90.4,128 82.4,131.5 \\n\\t\\t8.6,164.1 8.6,130.7 45.8,114.9 37.6,111.3 2.1,126.4 2.1,174 90.3,135.1 98.3,131.6 136.1,114.9 144.2,111.3 168,100.7 168,83.8 \\t\\n\\t\\t\\\"/>\\n</g>\\n</svg>\\n\";","/*\n * constants.ts\n *\n * Copyright (C) 2022 by Posit Software, PBC\n *\n */\n// This file shares variables with './workbench_jupyterlab/constants.py'\n// Changes made to this file may need to be duplicated there.\n// default process names\nexport const kShinyApp = 'Shiny Project';\nexport const kQuartoApp = 'Quarto Project';\n// workbench_jupyterlab server extension endpoints\nexport const kServerEndpoint = 'servers';\nexport const kUrlEndpoint = 'url';\nexport const kHeartbeatEndpoint = 'heartbeat';\n","/*\n * disconnectAlert.tsx\n *\n * Copyright (C) 2023 by Posit Software, PBC\n *\n */\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { disconnectRetry, listen } from './disconnectMonitor';\nimport * as ReactDOM from 'react-dom';\nexport function WorkbenchDisconnectWidget() {\n    const [message, setMessage] = useState('');\n    const [visible, setVisible] = useState(false);\n    const [onAccept, setOnAccept] = useState();\n    const [buttonFocus, setButtonFocus] = useState(1);\n    const ref = useRef(null);\n    useEffect(() => {\n        let timestamp = 0;\n        let timerId = -1;\n        const updateMessage = () => {\n            window.clearTimeout(timerId);\n            const timeDiff = Date.now() - timestamp;\n            const seconds = Math.floor(timeDiff / 1000);\n            const minutes = Math.floor(seconds / 60);\n            setMessage(`The underlying JupyterLab connection has been closed for <span aria-role=\"timer\">${minutes}:${String(seconds % 60).padStart(2, '0')}</span>.<br>Attempting to reconnect...`);\n            timerId = window.setTimeout(() => {\n                updateMessage();\n            }, 1000);\n        };\n        const listener = params => {\n            if (typeof params.timestamp === 'number') {\n                timestamp = params.timestamp;\n            }\n            if (typeof params.onAccept === 'function') {\n                setOnAccept(() => params.onAccept);\n            }\n            if (typeof params.dismiss === 'boolean') {\n                setVisible(!params.dismiss);\n                if (params.dismiss) {\n                    window.clearTimeout(timerId);\n                }\n                else {\n                    updateMessage();\n                }\n            }\n        };\n        const unlisten = listen(listener);\n        return (() => {\n            window.clearTimeout(timerId);\n            unlisten();\n        });\n    }, []);\n    const updateFocus = (direction = 0) => {\n        if (!ref.current) {\n            return;\n        }\n        const el = ref.current;\n        const buttons = el.querySelectorAll('button');\n        let currentFocus = buttonFocus;\n        if (direction) {\n            currentFocus = (buttons.length + currentFocus + Math.sign(direction)) % buttons.length;\n        }\n        buttons[currentFocus].focus();\n        setButtonFocus(currentFocus);\n    };\n    useEffect(() => {\n        if (!ref.current) {\n            return;\n        }\n        const el = ref.current;\n        el.style.display = '';\n        const anim = el.animate([\n            {\n                opacity: visible ? 0 : 1\n            },\n            {\n                opacity: visible ? 1 : 0\n            }\n        ], 150);\n        const onFinish = () => {\n            el.style.display = visible ? '' : 'none';\n            if (visible) {\n                updateFocus();\n            }\n        };\n        anim.addEventListener('finish', onFinish);\n        return (() => {\n            anim.removeEventListener('finish', onFinish);\n        });\n    }, [visible]);\n    const onKeyDown = (evt) => {\n        switch (evt.code) {\n            case 'ArrowLeft':\n            case 'ArrowRight':\n            case 'Tab':\n                evt.preventDefault();\n                evt.stopPropagation();\n                updateFocus(1);\n        }\n    };\n    return (React.createElement(\"div\", { ref: ref, id: \"workbench-disconnect-alert\", className: \"jp-workbench-disconnect-alert jp-Dialog-content\", style: { display: 'none' }, tabIndex: 0, \"aria-role\": \"alertdialog\", \"aria-hidden\": !visible, \"aria-describedby\": \"workbench-disconnect-alert-message\", onKeyDown: onKeyDown },\n        React.createElement(\"div\", { id: \"workbench-disconnect-alert-message\", style: { gridArea: 'message' }, dangerouslySetInnerHTML: { __html: message } }),\n        React.createElement(\"button\", { id: \"workbench-disconnect-alert-dismiss\", style: { gridArea: 'dismiss' }, className: \"jp-Dialog-button jp-mod-accept jp-mod-styled\", onClick: () => { onAccept(); }, \"aria-label\": \"Return to Workbench Home\" }, \"Workbench Home\"),\n        React.createElement(\"button\", { id: \"workbench-disconnect-alert-retry\", style: { gridArea: 'retry' }, className: \"jp-Dialog-button jp-mod-reject jp-mod-styled\", onClick: () => { disconnectRetry(onAccept); }, \"aria-label\": \"Retry connection now\" }, \"Retry Now\")));\n}\nexport function setupDisconnectNotification() {\n    const id = 'workbench-disconnect-layer';\n    let host = document.getElementById(id);\n    if (!host) {\n        host = document.createElement('div');\n        host.id = id;\n        host.style.cssText = `\n      position: absolute;\n      bottom: 26px;\n      right: 34px;\n      z-index: 1000;\n    `;\n        document.body.append(host);\n    }\n    ReactDOM.render(React.createElement(WorkbenchDisconnectWidget, null), host);\n}\n","/*\n * disconnectMonitor.ts\n *\n * Copyright (C) 2023 by Posit Software, PBC\n *\n */\nimport { Dialog } from '@jupyterlab/apputils';\nimport { requestAPI } from './handler';\nimport { kHeartbeatEndpoint } from './constants';\nlet heartbeatId = -1;\nconst retryIntervals = [2, 2, 2, 2, 5, 5, 10, 20, 30];\nlet retryCount = 0;\nlet retryTimer = -1;\nlet disconnectTimestamp = 0;\nlet existingDialog;\nasync function displayModal(onAccept) {\n    // dialog already open, do not re-open\n    // it is cleared when the user responds to input\n    if (existingDialog) {\n        return;\n    }\n    const acceptButton = Dialog.createButton({\n        accept: true,\n        label: 'Workbench Home'\n    });\n    const retryButton = Dialog.createButton({\n        accept: false,\n        label: 'Retry Now'\n    });\n    existingDialog = new Dialog({\n        body: 'The underlying JupyterLab connection has been closed.',\n        title: 'Disconnected from Workbench',\n        hasClose: false,\n        buttons: [acceptButton, retryButton]\n    });\n    const result = await existingDialog.launch();\n    if (result.button === acceptButton) {\n        onAccept();\n    }\n    else if (result.button === retryButton) {\n        disconnectRetry(onAccept);\n    }\n    existingDialog.close();\n    existingDialog = undefined;\n}\nconst listeners = new Set();\nexport function listen(listener) {\n    const unlisten = () => {\n        listeners.delete(listener);\n    };\n    listeners.add(listener);\n    return unlisten;\n}\nfunction upsertNotification(onAccept) {\n    for (const listener of listeners.values()) {\n        listener({\n            timestamp: disconnectTimestamp,\n            dismiss: false,\n            onAccept\n        });\n    }\n}\nfunction dismissNotification() {\n    for (const listener of listeners) {\n        listener({\n            dismiss: true\n        });\n    }\n}\nexport function disconnectRetry(returnHome) {\n    // assume that we are dead in the water, start a series of delays to re-poll for connection\n    // fire an event to the homepage to display an error\n    const retryPoll = async (currentTry = retryCount) => {\n        retryCount = currentTry;\n        window.clearTimeout(retryTimer);\n        try {\n            const result = await requestAPI(kHeartbeatEndpoint);\n            if (!result.result) {\n                throw new Error('response was invalid');\n            }\n            // if this succeeds then cancel retries and resume\n            retryCount = 0;\n            dismissNotification();\n            heartbeat(returnHome);\n        }\n        catch (err) {\n            // it's severe if we reach the end of retry intervals\n            if (currentTry > 1) {\n                if (retryCount < retryIntervals.length - 1) {\n                    // show / update notification\n                    upsertNotification(returnHome);\n                }\n                else {\n                    // show modal\n                    // this will just pause everything until the user does something about it,\n                    // since modals cannot be closed remotely\n                    dismissNotification();\n                    await displayModal(returnHome);\n                }\n            }\n            retryTimer = window.setTimeout(() => { retryPoll(Math.min(currentTry + 1, retryIntervals.length - 1)); }, retryIntervals[currentTry] * 1000);\n        }\n    };\n    retryPoll();\n}\nexport function heartbeat(returnHome) {\n    window.clearTimeout(heartbeatId);\n    heartbeatId = window.setTimeout(async () => {\n        try {\n            const result = await requestAPI(kHeartbeatEndpoint);\n            if (!result.result) {\n                throw new Error('response was invalid');\n            }\n            heartbeat(returnHome);\n        }\n        catch (err) {\n            disconnectTimestamp = Date.now();\n            disconnectRetry(returnHome);\n        }\n    }, 30000);\n}\nexport function stopHeartbeat() {\n    window.clearTimeout(heartbeatId);\n}\n","/*\n * handler.ts\n *\n * Copyright (C) 2022 by Posit Software, PBC\n *\n */\nimport { URLExt } from '@jupyterlab/coreutils';\nimport { ServerConnection } from '@jupyterlab/services';\n/**\n * Call the API extension\n *\n * @param endPoint API REST end point for the extension\n * @param init Initial values for the request\n * @returns The response body interpreted as JSON\n */\nexport async function requestAPI(endPoint = '', init = {}) {\n    // Make request to Jupyter API\n    const settings = ServerConnection.makeSettings();\n    const requestUrl = URLExt.join(settings.baseUrl, 'workbench-jupyterlab', // API Namespace\n    endPoint);\n    let response;\n    response = await ServerConnection.makeRequest(requestUrl, init, settings);\n    let data = await response.text();\n    if (data.length > 0) {\n        try {\n            data = JSON.parse(data);\n        }\n        catch (error) {\n            console.log('Not a JSON response body.', response);\n        }\n    }\n    if (!response.ok) {\n        throw new ServerConnection.ResponseError(response, data.message || data);\n    }\n    return data;\n}\n","/*\n * index.ts\n *\n * Copyright (C) 2022 by Posit Software, PBC\n *\n */\nimport rstudioHome from '../images/posit-icon-fullcolor.svg';\nimport rstudioPanel from '../images/posit-icon-unstyled.svg';\nimport { RStudioWorkbenchWidget } from './widget';\nimport { Panel, Widget } from '@lumino/widgets';\nimport { ICommandPalette } from '@jupyterlab/apputils';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { ServerConnection } from '@jupyterlab/services';\nimport { heartbeat, stopHeartbeat } from './disconnectMonitor';\nimport { setupDisconnectNotification } from './disconnectAlert';\nlet homeUrl = '/home';\nconst rstudioIcon = new LabIcon({\n    name: 'workbench_jupyterlab:home-icon',\n    svgstr: rstudioHome,\n});\nconst rstudioPanelIcon = new LabIcon({\n    name: 'workbench_jupyterlab:panel-icon',\n    svgstr: rstudioPanel,\n});\nfunction returnHome() {\n    location.assign(homeUrl);\n}\nfunction registerCommands(app, palette) {\n    var regex = /(s\\/[\\w]{5}[\\w]{8}[\\w]{8}\\/)/g;\n    const settings = ServerConnection.makeSettings();\n    homeUrl = settings.baseUrl.replace(regex, 'home/');\n    // Register command to return to RStudio Workbench home\n    const command = 'workbench_jupyterlab:return-home';\n    app.commands.addCommand(command, {\n        label: 'Return to Posit Workbench Home',\n        caption: 'Return to Posit Workbench Home',\n        execute: returnHome\n    });\n    palette.addItem({ command, category: 'Posit Workbench' });\n}\nfunction addRStudioIcon(app) {\n    // Add RStudio icon that returns the user to home to menu bar\n    const rstudio_widget = new Widget();\n    rstudio_widget.id = 'rsw-icon';\n    rstudio_widget.node.onclick = returnHome;\n    rstudioIcon.element({\n        container: rstudio_widget.node,\n        justify: 'center',\n        margin: '2px 5px 2px 5px',\n        height: 'auto',\n        width: '20px',\n    });\n    app.shell.add(rstudio_widget, 'top', { rank: 1 });\n}\nfunction addSideBar(app) {\n    // Add the RSW side bar widget to the left panel\n    const panel = new Panel();\n    panel.id = 'RStudio-Workbench-tab';\n    panel.title.icon = rstudioPanelIcon;\n    panel.addWidget(new RStudioWorkbenchWidget());\n    app.shell.add(panel, 'left', { rank: 501 });\n}\nfunction activate(app, palette) {\n    registerCommands(app, palette);\n    addRStudioIcon(app);\n    addSideBar(app);\n    heartbeat(returnHome);\n    setupDisconnectNotification();\n}\nfunction deactivate() {\n    stopHeartbeat();\n}\nconst plugin = {\n    // Initialization data for the workbench_jupyterlab extension.\n    id: 'workbench-jupyterlab',\n    autoStart: true,\n    requires: [ICommandPalette],\n    activate,\n    deactivate\n};\nexport default plugin;\n","/*\n * proxiedServersComponent.tsx\n *\n * Copyright (C) 2022 by Posit Software, PBC\n *\n */\n// This file shares variables with './workbench_jupyterlab/constants.py'\nimport React, { Component, Fragment } from 'react';\nimport { launcherIcon } from '@jupyterlab/ui-components';\nconst TitleComponent = (props) => {\n    const headerId = ('title_component_' + props.title).replace(/\\s+/g, '_');\n    return (React.createElement(\"div\", null,\n        React.createElement(\"header\", { id: headerId }, props.title)));\n};\nconst ServerComponent = (props) => {\n    const hyperlinkId = 'server_link_' + props.server.html_id;\n    const liId = 'server_component_' + props.server.html_id;\n    const serverNameId = 'server_name_' + props.server.html_id;\n    const serverInfoId = 'server_info_' + props.server.html_id;\n    return (React.createElement(Fragment, { \"aria-role\": 'link', \"aria-label\": 'Open link for proxied server ' + props.server.label },\n        React.createElement(\"a\", { id: hyperlinkId, target: \"_blank\", title: props.server.title, href: props.server.securePath },\n            React.createElement(\"li\", { id: liId },\n                React.createElement(launcherIcon.react, { paddingRight: 5 }),\n                React.createElement(\"span\", { id: serverNameId, className: 'jp-ServerName' }, props.server.label),\n                React.createElement(\"span\", { id: serverInfoId, className: 'jp-ServerInfo' },\n                    props.server.ip,\n                    \":\",\n                    props.server.port)))));\n};\nexport class ProxiedServersComponent extends Component {\n    constructor(props) {\n        super(props);\n    }\n    render() {\n        const serverItems = this.props.servers.map((server) => React.createElement(ServerComponent, { server: server }));\n        return (React.createElement(Fragment, null,\n            React.createElement(TitleComponent, { title: 'Proxied Servers' }),\n            React.createElement(\"div\", null,\n                React.createElement(\"ul\", { id: 'proxied_servers_list' }, serverItems))));\n    }\n}\nexport class Server {\n    constructor(pid, name, port, ip, securePath) {\n        this.pid = pid;\n        this.label = name;\n        this.port = port;\n        this.ip = ip;\n        this.securePath = securePath;\n        this.title = securePath && securePath != '' ? securePath : 'Could not create secure url.';\n        let id_str = this.label + '_' + port;\n        id_str = id_str.replace(/\\s+|-/g, '_'); // replace spaces with an underscore\n        this.html_id = id_str.replace(/_+/g, '_'); // remove any duplicated underscores\n    }\n}\n;\n","/*\n * widget.tsx\n *\n * Copyright (C) 2022 by Posit Software, PBC\n *\n */\n// This file shares variables with './workbench_jupyterlab/constants.py'\nimport { kServerEndpoint, kUrlEndpoint } from './constants';\nimport { requestAPI } from './handler';\nimport { ProxiedServersComponent, Server } from './proxiedServersComponent';\nimport { ReactWidget, UseSignal } from '@jupyterlab/apputils';\nimport { Signal } from '@lumino/signaling';\nimport React from 'react';\nfunction UseSignalComponent(props) {\n    return (React.createElement(UseSignal, { signal: props.signal, initialArgs: props.servers }, (_, servers) => React.createElement(ProxiedServersComponent, { servers: servers })));\n}\nexport class RStudioWorkbenchWidget extends ReactWidget {\n    constructor() {\n        super();\n        this.servers = new Map();\n        this._signal = new Signal(this);\n        this._serverString = '';\n        this._sessionUrl = '';\n        this.addClass('jp-RStudioWorkbenchWidget');\n    }\n    getSessionUrl() {\n        requestAPI(kUrlEndpoint).then((response) => {\n            try {\n                this._sessionUrl = response.baseSessionUrl;\n            }\n            catch (error) {\n                console.log(`Received invalid response on GET /workbench-jupyterlab/url. \\n${error}`);\n            }\n        }, (error) => {\n            console.log(`Error on GET /workbench-jupyterlab/url. \\n${error}`);\n        });\n    }\n    requestServers() {\n        requestAPI(kServerEndpoint).then((response) => {\n            if (JSON.stringify(response.servers) != this._serverString) {\n                this._serverString = JSON.stringify(response.servers);\n                this.servers.clear();\n                try {\n                    response.servers.forEach((server) => {\n                        this.servers.set(server.pid, [new Server(server.pid, server.label, server.port, server.ip, `${this._sessionUrl}p/${server.secure_port}/`)]);\n                    });\n                    this._signal.emit(this.getServers());\n                }\n                catch (error) {\n                    console.log(`Received invalid response on GET /workbench-jupyterlab/servers. \\n${response}`);\n                    return;\n                }\n            }\n        }, (error) => {\n            console.log(`Error on GET /workbench-jupyterlab/servers. \\n${error}`);\n        });\n    }\n    async onAfterAttach(msg) {\n        super.onAfterAttach(msg);\n        this.requestServers();\n    }\n    async onBeforeShow(msg) {\n        super.onBeforeShow(msg);\n        this.getSessionUrl();\n        this.requestServers();\n        this._timerID = setInterval(() => this.requestServers(), 3000);\n    }\n    onAfterHide(msg) {\n        super.onAfterHide(msg);\n        clearInterval(this._timerID);\n    }\n    getServers() {\n        let serverArray = [];\n        this.servers.forEach((value, key) => {\n            serverArray = serverArray.concat(value);\n        });\n        return serverArray;\n    }\n    render() {\n        return (React.createElement(UseSignalComponent, { signal: this._signal, servers: this.getServers() }));\n    }\n}\n"],"names":[],"sourceRoot":""}