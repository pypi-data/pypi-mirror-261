device_type: "ssh"

job_name: "tuxrun@ssh-device: ltp-smoke"
priority: "medium"
visibility: "public"
timeouts:
  job:
    minutes: 5
  action:
   minutes: 5
  actions:
    power-off:
      seconds: 30

actions:
- deploy:
    to: ssh
    os: debian
- boot:
    method: ssh
    connection: serial
    failure_retry: 2
    timeout:
      minutes: 3
    prompts:
    - 'root@(.*):[/~]#'
    - "testuser"
- test:
    timeout:
      minutes: 2
    definitions:
    - repository: file://testdef.tar.zst
      lava-signal: kmsg
      from: url
      compression: zstd
      path: automated/linux/ltp/ltp.yaml
      parameters:
        SKIP_INSTALL: 'true'
        TST_CMDFILES: 'smoketest'
        SKIPFILE: '/tuxtest/skipfiles/arm64/ltp-smoke'
        ENVIRONMENT: 'production'
        TIMEOUT_MULTIPLIER: '5'
        LTP_TMPDIR: '/scratch'
        LTP_INSTALL_PATH: '/opt/ltp/'
        SHARD_NUMBER: 1
        SHARD_INDEX: 1
      name: ltp-smoke
