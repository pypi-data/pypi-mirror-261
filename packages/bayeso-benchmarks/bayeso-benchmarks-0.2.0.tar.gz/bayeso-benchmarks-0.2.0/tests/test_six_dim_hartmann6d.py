#
# author: Jungtaek Kim (jtkim@postech.ac.kr)
# last updated: December 4, 2022
#

import numpy as np
import pytest

from bayeso_benchmarks.six_dim_hartmann6d import *

class_fun = Hartmann6D
str_name = 'hartmann6d'

TEST_EPSILON = 1e-5


def test_init():
    obj_fun = class_fun()

    with pytest.raises(AssertionError) as error:
        class_fun(seed='abc')
    with pytest.raises(AssertionError) as error:
        class_fun(seed=2.1)

def test_validate_properties():
    obj_fun = class_fun()
    obj_fun.validate_properties()

def test_output():
    obj_fun = class_fun()
    bounds = obj_fun.get_bounds()

    grids = obj_fun.sample_grids(3)
    truths_grids = np.array([
        [-5.08911288e-03],
        [-1.39417909e-01],
        [-7.03642418e-02],
        [-1.28869208e-02],
        [-3.53479936e-01],
        [-1.78361572e-01],
        [-2.54689221e-04],
        [-3.71921487e-03],
        [-1.06424677e-03],
        [-7.71014520e-03],
        [-2.03302912e-01],
        [-1.02872411e-01],
        [-1.90092977e-02],
        [-5.15263796e-01],
        [-2.60720627e-01],
        [-4.31653377e-04],
        [-1.82166544e-03],
        [-5.57722931e-04],
        [-1.34601938e-04],
        [-2.04523802e-03],
        [-1.02727639e-03],
        [-2.49175535e-04],
        [-5.18358536e-03],
        [-2.60138785e-03],
        [-6.29850385e-05],
        [-1.21979697e-04],
        [-3.33663146e-05],
        [-2.01973752e-02],
        [-3.79140190e-01],
        [-1.72776742e-01],
        [-5.31354735e-02],
        [-9.88341220e-01],
        [-3.77506742e-01],
        [-4.34890158e-02],
        [-6.52731890e-01],
        [-1.79563032e-01],
        [-1.52764672e-02],
        [-3.35264377e-01],
        [-1.78871699e-01],
        [-3.90210622e-02],
        [-8.60382551e-01],
        [-3.87506085e-01],
        [-1.92650287e-02],
        [-2.84407512e-01],
        [-7.83150773e-02],
        [-6.16609104e-04],
        [-1.03409268e-02],
        [-3.30619590e-02],
        [-1.53231605e-03],
        [-2.51342950e-02],
        [-1.72736777e-02],
        [-1.48864416e-03],
        [-2.14985611e-02],
        [-5.96035595e-03],
        [-3.57243075e-03],
        [-9.53672207e-02],
        [-1.65567290e-01],
        [-9.10553914e-03],
        [-2.34536318e-01],
        [-1.49844278e-01],
        [-1.64812933e-03],
        [-2.46029476e-02],
        [-6.99010494e-03],
        [-5.02661669e-03],
        [-1.29938794e-01],
        [-1.85603313e-01],
        [-1.22155389e-02],
        [-3.21392180e-01],
        [-1.97089704e-01],
        [-1.04757111e-03],
        [-1.08440287e-02],
        [-3.21702233e-03],
        [-1.23405921e-04],
        [-5.08713433e-03],
        [-1.18652035e-01],
        [-2.19152932e-04],
        [-4.87166863e-03],
        [-3.73950140e-02],
        [-1.11007245e-04],
        [-8.17050467e-04],
        [-4.19803489e-04],
        [-4.98627198e-03],
        [-1.32458341e-01],
        [-6.70204937e-02],
        [-1.23500430e-02],
        [-3.35717210e-01],
        [-1.69856989e-01],
        [-2.51130043e-04],
        [-1.25998552e-03],
        [-3.83966561e-04],
        [-1.18067119e-02],
        [-1.94142004e-01],
        [-9.81966234e-02],
        [-2.25031920e-02],
        [-4.91644737e-01],
        [-2.48857619e-01],
        [-4.47221414e-03],
        [-9.50824094e-04],
        [-2.57363332e-04],
        [-8.96938712e-04],
        [-1.96888061e-03],
        [-9.74727532e-04],
        [-9.92865242e-04],
        [-4.92524484e-03],
        [-2.46720543e-03],
        [-7.67213164e-04],
        [-7.73899702e-05],
        [-1.10377943e-05],
        [-1.02145839e-02],
        [-2.23252421e-01],
        [-1.28189573e-01],
        [-2.61884889e-02],
        [-5.72693200e-01],
        [-2.58912791e-01],
        [-1.34364265e-02],
        [-1.99122393e-01],
        [-5.48427318e-02],
        [-1.51665230e-02],
        [-2.60067875e-01],
        [-1.55614367e-01],
        [-3.10431745e-02],
        [-6.60493738e-01],
        [-3.26162430e-01],
        [-1.03515667e-02],
        [-8.71324338e-02],
        [-2.40128029e-02],
        [-1.07842858e-03],
        [-5.38157507e-03],
        [-3.16372526e-02],
        [-1.43191616e-03],
        [-1.18269962e-02],
        [-1.35338549e-02],
        [-1.22548209e-03],
        [-6.59622416e-03],
        [-1.85266330e-03],
        [-3.24646485e-03],
        [-8.60695727e-02],
        [-1.62042071e-01],
        [-7.94897734e-03],
        [-2.10194240e-01],
        [-1.40928970e-01],
        [-6.80649908e-04],
        [-7.58417793e-03],
        [-2.30729429e-03],
        [-9.28302411e-03],
        [-1.22277348e-01],
        [-1.82060775e-01],
        [-1.58335639e-02],
        [-3.01279219e-01],
        [-1.88253232e-01],
        [-4.82231893e-03],
        [-3.64585053e-03],
        [-1.17571514e-03],
        [-9.05731357e-04],
        [-4.88738991e-03],
        [-1.18473356e-01],
        [-9.66875140e-04],
        [-4.28343285e-03],
        [-3.71602329e-02],
        [-8.10268545e-04],
        [-2.94248069e-04],
        [-2.65456530e-04],
        [-1.01866285e-03],
        [-2.81614256e-02],
        [-1.42683928e-02],
        [-2.58074116e-03],
        [-7.13682077e-02],
        [-3.61563426e-02],
        [-1.96640000e-06],
        [-3.90396482e-05],
        [-1.92547684e-05],
        [-1.50675227e-03],
        [-4.13036311e-02],
        [-2.09262322e-02],
        [-3.79755641e-03],
        [-1.04672823e-01],
        [-5.30289519e-02],
        [-1.45246242e-05],
        [-5.55811549e-05],
        [-2.76113094e-05],
        [-1.70921654e-05],
        [-4.08358502e-04],
        [-2.08294922e-04],
        [-3.97023325e-05],
        [-1.03459954e-03],
        [-5.24518085e-04],
        [-2.18273812e-06],
        [-7.17532844e-07],
        [-2.92797021e-07],
        [-1.22074825e-03],
        [-3.45514485e-02],
        [-4.68866044e-02],
        [-3.09402230e-03],
        [-8.55414071e-02],
        [-5.21413638e-02],
        [-2.93023413e-05],
        [-4.53875241e-04],
        [-1.84464412e-04],
        [-1.79439560e-03],
        [-5.01235291e-02],
        [-5.51586428e-02],
        [-4.52633232e-03],
        [-1.24968147e-01],
        [-7.22725892e-02],
        [-2.70749465e-05],
        [-2.44283645e-04],
        [-1.32013401e-04],
        [-2.02828415e-05],
        [-1.38096103e-03],
        [-2.93775538e-02],
        [-4.76589378e-05],
        [-1.51174593e-03],
        [-9.42872578e-03],
        [-3.14626116e-06],
        [-1.56943790e-05],
        [-5.27334259e-05],
        [-6.16929640e-04],
        [-2.06445976e-02],
        [-1.26429383e-01],
        [-1.56243078e-03],
        [-4.42787658e-02],
        [-5.74711985e-02],
        [-2.33338971e-06],
        [-4.36448190e-05],
        [-2.12476855e-04],
        [-9.17683116e-04],
        [-2.86381883e-02],
        [-1.31921681e-01],
        [-2.30369846e-03],
        [-6.44351026e-02],
        [-6.81199561e-02],
        [-1.46101013e-05],
        [-4.60953511e-05],
        [-2.17810367e-04],
        [-1.14595526e-05],
        [-3.75956349e-03],
        [-1.14981197e-01],
        [-2.50731250e-05],
        [-1.68766734e-03],
        [-3.50220260e-02],
        [-2.28614353e-06],
        [-6.81639226e-06],
        [-1.92367509e-04],
        [-5.65385855e-03],
        [-9.67927426e-02],
        [-4.87783652e-02],
        [-1.10377689e-02],
        [-2.45253274e-01],
        [-1.23633381e-01],
        [-2.16022665e-03],
        [-3.00626559e-03],
        [-8.27667950e-04],
        [-5.96745804e-02],
        [-1.43673045e-01],
        [-7.12804483e-02],
        [-6.67466444e-02],
        [-3.59809313e-01],
        [-1.80639418e-01],
        [-5.05533708e-02],
        [-3.99159225e-03],
        [-4.25845136e-04],
        [-9.46885958e-03],
        [-1.90313229e-03],
        [-7.19448618e-04],
        [-9.41744789e-03],
        [-4.07612031e-03],
        [-1.80669595e-03],
        [-8.71468740e-03],
        [-5.41662418e-04],
        [-2.61241964e-05],
        [-1.75032197e-02],
        [-2.86778842e-01],
        [-2.61287764e-01],
        [-4.25031506e-02],
        [-7.39107298e-01],
        [-3.17239160e-01],
        [-3.61907088e-02],
        [-5.12932271e-01],
        [-1.41292654e-01],
        [-6.72086761e-02],
        [-2.47990525e-01],
        [-2.64118285e-01],
        [-8.38363686e-02],
        [-6.23231468e-01],
        [-3.16432662e-01],
        [-6.69396289e-02],
        [-2.26098945e-01],
        [-6.17418747e-02],
        [-1.01429584e-02],
        [-1.23748708e-02],
        [-1.55824804e-01],
        [-1.07147972e-02],
        [-2.08773304e-02],
        [-5.25559751e-02],
        [-1.01090629e-02],
        [-1.73576281e-02],
        [-4.90015774e-03],
        [-4.72686643e-03],
        [-8.33353958e-02],
        [-6.51676513e-01],
        [-8.61164570e-03],
        [-1.69529355e-01],
        [-2.66539798e-01],
        [-3.32982852e-03],
        [-1.94516375e-02],
        [-6.36568260e-03],
        [-5.99005776e-02],
        [-1.09856252e-01],
        [-6.72115749e-01],
        [-6.41271814e-02],
        [-2.31382042e-01],
        [-3.00974859e-01],
        [-5.29470770e-02],
        [-1.12155571e-02],
        [-3.40987785e-03],
        [-9.81945025e-03],
        [-2.00546011e-02],
        [-6.05580038e-01],
        [-9.75203927e-03],
        [-8.77035978e-03],
        [-1.84066791e-01],
        [-9.08191769e-03],
        [-1.13102974e-03],
        [-1.18665197e-03],
        [-3.28854104e-02],
        [-9.33026658e-02],
        [-4.64416001e-02],
        [-3.75782465e-02],
        [-2.34134839e-01],
        [-1.17687234e-01],
        [-2.73967061e-02],
        [-2.37410310e-03],
        [-2.93622690e-04],
        [-7.61874317e-01],
        [-1.73296523e-01],
        [-6.80342229e-02],
        [-7.58740328e-01],
        [-3.78859295e-01],
        [-1.72399548e-01],
        [-7.00116229e-01],
        [-3.65832813e-02],
        [-1.91975636e-04],
        [-1.30680296e-01],
        [-8.06032335e-03],
        [-6.82655295e-04],
        [-1.28927185e-01],
        [-1.00162035e-02],
        [-1.71222014e-03],
        [-1.20809885e-01],
        [-6.24859784e-03],
        [-8.85605209e-06],
        [-3.78399741e-02],
        [-1.66427904e-01],
        [-2.26487863e-01],
        [-4.91552890e-02],
        [-4.15694906e-01],
        [-2.24902689e-01],
        [-3.86169732e-02],
        [-1.57879606e-01],
        [-4.33021740e-02],
        [-7.88231366e-01],
        [-2.27025613e-01],
        [-2.46238350e-01],
        [-7.88644125e-01],
        [-5.05314992e-01],
        [-2.69486569e-01],
        [-7.26783266e-01],
        [-1.05432244e-01],
        [-1.90795014e-02],
        [-1.34935782e-01],
        [-1.48902631e-02],
        [-1.54599672e-01],
        [-1.33325522e-01],
        [-1.67617823e-02],
        [-4.95970773e-02],
        [-1.24974560e-01],
        [-1.15727948e-02],
        [-1.67290629e-03],
        [-3.28126972e-02],
        [-7.78216699e-02],
        [-6.48633370e-01],
        [-3.56677578e-02],
        [-1.52716537e-01],
        [-2.59844642e-01],
        [-2.87686859e-02],
        [-7.42935626e-03],
        [-2.68601275e-03],
        [-7.88791593e-01],
        [-1.41680122e-01],
        [-6.69137063e-01],
        [-7.82393820e-01],
        [-2.53690230e-01],
        [-2.94549338e-01],
        [-7.26880074e-01],
        [-4.01007774e-02],
        [-1.80725208e-03],
        [-1.35632767e-01],
        [-2.63342699e-02],
        [-6.05004574e-01],
        [-1.33786771e-01],
        [-1.46716790e-02],
        [-1.83756753e-01],
        [-1.25414609e-01],
        [-6.68055294e-03],
        [-1.06493476e-03],
        [-7.88704703e-04],
        [-1.95121337e-02],
        [-9.89065653e-03],
        [-1.86961061e-03],
        [-4.94416263e-02],
        [-2.50478224e-02],
        [-7.81956838e-05],
        [-3.12038273e-05],
        [-1.34061382e-05],
        [-3.17111006e-03],
        [-2.87210161e-02],
        [-1.45026596e-02],
        [-4.72820200e-03],
        [-7.26155878e-02],
        [-3.67355781e-02],
        [-1.97745668e-03],
        [-1.39868750e-04],
        [-1.91674993e-05],
        [-3.78943109e-04],
        [-3.01976202e-04],
        [-1.50958168e-04],
        [-3.89469331e-04],
        [-7.35373946e-04],
        [-3.65354470e-04],
        [-3.41008654e-04],
        [-1.79807622e-05],
        [-2.16660605e-07],
        [-9.32256819e-04],
        [-2.80043448e-02],
        [-1.65034993e-01],
        [-2.22999296e-03],
        [-6.05174297e-02],
        [-7.61799080e-02],
        [-1.02079775e-04],
        [-3.63245556e-04],
        [-3.59881912e-04],
        [-3.43816804e-03],
        [-3.89431695e-02],
        [-1.72411676e-01],
        [-5.30041339e-03],
        [-8.79320643e-02],
        [-9.06178826e-02],
        [-2.04951519e-03],
        [-2.97099260e-04],
        [-3.20413163e-04],
        [-3.92909681e-04],
        [-4.92882310e-03],
        [-1.49594128e-01],
        [-4.06543231e-04],
        [-2.26174402e-03],
        [-4.55839513e-02],
        [-3.52504410e-04],
        [-3.67615719e-05],
        [-2.52998682e-04],
        [-5.14052700e-04],
        [-3.02878422e-02],
        [-6.10212903e-01],
        [-1.16754138e-03],
        [-3.55069860e-02],
        [-1.97729966e-01],
        [-8.14529696e-05],
        [-6.24894125e-05],
        [-1.02153856e-03],
        [-2.84441490e-03],
        [-3.61327903e-02],
        [-6.20517230e-01],
        [-3.77332715e-03],
        [-4.96364609e-02],
        [-2.07070224e-01],
        [-2.05236226e-03],
        [-1.64737930e-04],
        [-1.03588577e-03],
        [-3.89435933e-04],
        [-1.82072400e-02],
        [-5.89235961e-01],
        [-3.93233080e-04],
        [-5.89709436e-03],
        [-1.78236811e-01],
        [-3.53993075e-04],
        [-4.89687028e-05],
        [-9.85413505e-04],
        [-6.59238442e-03],
        [-1.20054976e-02],
        [-5.88472482e-03],
        [-7.16337480e-03],
        [-2.99557347e-02],
        [-1.49188254e-02],
        [-5.73435279e-03],
        [-7.95863576e-04],
        [-1.41626265e-04],
        [-1.58503337e-01],
        [-2.51058655e-02],
        [-8.58597372e-03],
        [-1.57239929e-01],
        [-5.10505477e-02],
        [-2.17604739e-02],
        [-1.46028887e-01],
        [-7.75075671e-03],
        [-6.98757292e-05],
        [-2.72517233e-02],
        [-1.57489907e-03],
        [-8.64394364e-05],
        [-2.68803827e-02],
        [-1.82043389e-03],
        [-2.18546903e-04],
        [-2.51975042e-02],
        [-1.31333070e-03],
        [-4.58467785e-06],
        [-8.81688553e-03],
        [-4.36456441e-02],
        [-2.04818492e-02],
        [-1.27688328e-02],
        [-1.13807862e-01],
        [-4.08846274e-02],
        [-1.18697031e-02],
        [-9.01972308e-02],
        [-2.47288254e-02],
        [-1.64465619e-01],
        [-4.14853618e-02],
        [-1.92229612e-02],
        [-1.64730523e-01],
        [-9.35514262e-02],
        [-3.69097743e-02],
        [-1.53242895e-01],
        [-4.69088018e-02],
        [-1.07807200e-02],
        [-2.81794379e-02],
        [-2.77742264e-03],
        [-5.67148756e-03],
        [-2.79052355e-02],
        [-4.57072125e-03],
        [-2.57043884e-03],
        [-2.61911117e-02],
        [-4.29877788e-03],
        [-8.22924646e-04],
        [-6.72515139e-03],
        [-9.06477998e-03],
        [-2.52860989e-02],
        [-7.14557312e-03],
        [-2.11513705e-02],
        [-1.62476551e-02],
        [-6.14315216e-03],
        [-3.68763318e-03],
        [-9.67810048e-04],
        [-1.64292995e-01],
        [-1.98115625e-02],
        [-2.70307765e-02],
        [-1.62620961e-01],
        [-3.57296690e-02],
        [-2.00493568e-02],
        [-1.51664456e-01],
        [-9.28514856e-03],
        [-4.47158849e-04],
        [-2.82874358e-02],
        [-2.23288187e-03],
        [-2.09746765e-02],
        [-2.79013952e-02],
        [-1.98218096e-03],
        [-6.47577875e-03],
        [-2.61619296e-02],
        [-1.45866944e-03],
        [-6.56436061e-05],
        [-8.59241826e-02],
        [-1.54658359e-02],
        [-5.59406400e-03],
        [-8.53439946e-02],
        [-3.23848795e-02],
        [-1.41776954e-02],
        [-7.91016625e-02],
        [-4.23440094e-03],
        [-4.83247082e-05],
        [-2.19086006e+00],
        [-1.28927151e-01],
        [-8.19575789e-03],
        [-2.16111393e+00],
        [-1.52170833e-01],
        [-2.07621247e-02],
        [-2.02556653e+00],
        [-1.04357711e-01],
        [-3.33704982e-05],
        [-3.77963549e-01],
        [-1.96177796e-02],
        [-8.25084491e-05],
        [-3.72684501e-01],
        [-1.95931770e-02],
        [-2.07134029e-04],
        [-3.49534811e-01],
        [-1.79984504e-02],
        [-2.29591959e-06],
        [-8.93010949e-02],
        [-2.67856599e-02],
        [-1.45415617e-02],
        [-8.97934230e-02],
        [-6.17215001e-02],
        [-2.50612786e-02],
        [-8.34202455e-02],
        [-3.16147332e-02],
        [-7.55051221e-03],
        [-2.26055311e+00],
        [-1.39614600e-01],
        [-1.63196907e-02],
        [-2.23044003e+00],
        [-1.73892940e-01],
        [-2.92155744e-02],
        [-2.09046707e+00],
        [-1.19524938e-01],
        [-3.30628821e-03],
        [-3.89946799e-01],
        [-2.07198647e-02],
        [-5.47804038e-03],
        [-3.84534811e-01],
        [-2.11117028e-02],
        [-2.06329506e-03],
        [-3.60657558e-01],
        [-1.94657058e-02],
        [-2.57948625e-04],
        [-8.90381136e-02],
        [-1.22259248e-02],
        [-2.48993264e-02],
        [-8.82031892e-02],
        [-2.24920412e-02],
        [-1.52788414e-02],
        [-8.21675069e-02],
        [-5.26420602e-03],
        [-3.23119186e-04],
        [-2.27392323e+00],
        [-1.27622303e-01],
        [-2.66943813e-02],
        [-2.24267185e+00],
        [-1.40762494e-01],
        [-1.92176473e-02],
        [-2.10261399e+00],
        [-1.08698362e-01],
        [-1.70895763e-04],
        [-3.92333810e-01],
        [-2.09430258e-02],
        [-2.09484462e-02],
        [-3.86851230e-01],
        [-2.03812838e-02],
        [-6.44687435e-03],
        [-3.62827834e-01],
        [-1.87126054e-02],
        [-4.51927134e-05],
        [-3.26294369e-04],
        [-2.36067775e-03],
        [-1.18991047e-03],
        [-4.53174149e-04],
        [-5.96331690e-03],
        [-3.01493025e-03],
        [-2.23373504e-04],
        [-1.48656613e-05],
        [-1.63942185e-06],
        [-6.30676167e-03],
        [-3.76227163e-03],
        [-1.74507714e-03],
        [-6.41129847e-03],
        [-9.04181589e-03],
        [-4.42183260e-03],
        [-5.71750323e-03],
        [-2.98950322e-04],
        [-2.33080844e-06],
        [-1.06805061e-03],
        [-8.89639198e-05],
        [-1.75125348e-05],
        [-1.05501271e-03],
        [-1.40413277e-04],
        [-4.37825127e-05],
        [-9.86595170e-04],
        [-5.08424046e-05],
        [-2.81245054e-08],
        [-3.51268205e-04],
        [-2.98691434e-03],
        [-6.71697126e-03],
        [-5.04794192e-04],
        [-7.19077504e-03],
        [-5.20076875e-03],
        [-2.34188602e-04],
        [-7.20489018e-05],
        [-2.61784599e-05],
        [-6.52659463e-03],
        [-4.59778100e-03],
        [-7.44050157e-03],
        [-6.66552681e-03],
        [-1.07787090e-02],
        [-6.88692805e-03],
        [-5.90011395e-03],
        [-3.33758882e-04],
        [-1.84295783e-05],
        [-1.10209415e-03],
        [-2.55682914e-04],
        [-5.18503546e-03],
        [-1.08900624e-03],
        [-2.07823581e-04],
        [-1.61289536e-03],
        [-1.01794449e-03],
        [-5.45656746e-05],
        [-9.17478486e-06],
        [-3.01998702e-04],
        [-2.07285020e-03],
        [-2.16034133e-02],
        [-3.77356905e-04],
        [-3.80778858e-03],
        [-8.13461009e-03],
        [-2.31938881e-04],
        [-1.69651123e-05],
        [-3.64435778e-05],
        [-6.49269710e-03],
        [-3.06083421e-03],
        [-2.21989194e-02],
        [-6.51850527e-03],
        [-5.80231567e-03],
        [-9.06401290e-03],
        [-5.93489370e-03],
        [-3.10231795e-04],
        [-3.70027561e-05],
        [-1.10814922e-03],
        [-7.00301267e-04],
        [-2.03726271e-02],
        [-1.09378813e-03],
        [-2.96601645e-04],
        [-6.17908587e-03],
        [-1.02411386e-03],
        [-5.38568035e-05],
        [-3.40853927e-05],
    ])

    print(grids)
    print(obj_fun.output(grids))
    print(np.abs(obj_fun.output(grids) - truths_grids) < TEST_EPSILON)
    assert np.all(np.abs(obj_fun.output(grids) - truths_grids) < TEST_EPSILON)

def test_call():
    obj_fun = class_fun()
    bounds = obj_fun.get_bounds()

    grids = obj_fun.sample_grids(3)
    truths_grids = np.array([
        [-5.08911288e-03],
        [-1.39417909e-01],
        [-7.03642418e-02],
        [-1.28869208e-02],
        [-3.53479936e-01],
        [-1.78361572e-01],
        [-2.54689221e-04],
        [-3.71921487e-03],
        [-1.06424677e-03],
        [-7.71014520e-03],
        [-2.03302912e-01],
        [-1.02872411e-01],
        [-1.90092977e-02],
        [-5.15263796e-01],
        [-2.60720627e-01],
        [-4.31653377e-04],
        [-1.82166544e-03],
        [-5.57722931e-04],
        [-1.34601938e-04],
        [-2.04523802e-03],
        [-1.02727639e-03],
        [-2.49175535e-04],
        [-5.18358536e-03],
        [-2.60138785e-03],
        [-6.29850385e-05],
        [-1.21979697e-04],
        [-3.33663146e-05],
        [-2.01973752e-02],
        [-3.79140190e-01],
        [-1.72776742e-01],
        [-5.31354735e-02],
        [-9.88341220e-01],
        [-3.77506742e-01],
        [-4.34890158e-02],
        [-6.52731890e-01],
        [-1.79563032e-01],
        [-1.52764672e-02],
        [-3.35264377e-01],
        [-1.78871699e-01],
        [-3.90210622e-02],
        [-8.60382551e-01],
        [-3.87506085e-01],
        [-1.92650287e-02],
        [-2.84407512e-01],
        [-7.83150773e-02],
        [-6.16609104e-04],
        [-1.03409268e-02],
        [-3.30619590e-02],
        [-1.53231605e-03],
        [-2.51342950e-02],
        [-1.72736777e-02],
        [-1.48864416e-03],
        [-2.14985611e-02],
        [-5.96035595e-03],
        [-3.57243075e-03],
        [-9.53672207e-02],
        [-1.65567290e-01],
        [-9.10553914e-03],
        [-2.34536318e-01],
        [-1.49844278e-01],
        [-1.64812933e-03],
        [-2.46029476e-02],
        [-6.99010494e-03],
        [-5.02661669e-03],
        [-1.29938794e-01],
        [-1.85603313e-01],
        [-1.22155389e-02],
        [-3.21392180e-01],
        [-1.97089704e-01],
        [-1.04757111e-03],
        [-1.08440287e-02],
        [-3.21702233e-03],
        [-1.23405921e-04],
        [-5.08713433e-03],
        [-1.18652035e-01],
        [-2.19152932e-04],
        [-4.87166863e-03],
        [-3.73950140e-02],
        [-1.11007245e-04],
        [-8.17050467e-04],
        [-4.19803489e-04],
        [-4.98627198e-03],
        [-1.32458341e-01],
        [-6.70204937e-02],
        [-1.23500430e-02],
        [-3.35717210e-01],
        [-1.69856989e-01],
        [-2.51130043e-04],
        [-1.25998552e-03],
        [-3.83966561e-04],
        [-1.18067119e-02],
        [-1.94142004e-01],
        [-9.81966234e-02],
        [-2.25031920e-02],
        [-4.91644737e-01],
        [-2.48857619e-01],
        [-4.47221414e-03],
        [-9.50824094e-04],
        [-2.57363332e-04],
        [-8.96938712e-04],
        [-1.96888061e-03],
        [-9.74727532e-04],
        [-9.92865242e-04],
        [-4.92524484e-03],
        [-2.46720543e-03],
        [-7.67213164e-04],
        [-7.73899702e-05],
        [-1.10377943e-05],
        [-1.02145839e-02],
        [-2.23252421e-01],
        [-1.28189573e-01],
        [-2.61884889e-02],
        [-5.72693200e-01],
        [-2.58912791e-01],
        [-1.34364265e-02],
        [-1.99122393e-01],
        [-5.48427318e-02],
        [-1.51665230e-02],
        [-2.60067875e-01],
        [-1.55614367e-01],
        [-3.10431745e-02],
        [-6.60493738e-01],
        [-3.26162430e-01],
        [-1.03515667e-02],
        [-8.71324338e-02],
        [-2.40128029e-02],
        [-1.07842858e-03],
        [-5.38157507e-03],
        [-3.16372526e-02],
        [-1.43191616e-03],
        [-1.18269962e-02],
        [-1.35338549e-02],
        [-1.22548209e-03],
        [-6.59622416e-03],
        [-1.85266330e-03],
        [-3.24646485e-03],
        [-8.60695727e-02],
        [-1.62042071e-01],
        [-7.94897734e-03],
        [-2.10194240e-01],
        [-1.40928970e-01],
        [-6.80649908e-04],
        [-7.58417793e-03],
        [-2.30729429e-03],
        [-9.28302411e-03],
        [-1.22277348e-01],
        [-1.82060775e-01],
        [-1.58335639e-02],
        [-3.01279219e-01],
        [-1.88253232e-01],
        [-4.82231893e-03],
        [-3.64585053e-03],
        [-1.17571514e-03],
        [-9.05731357e-04],
        [-4.88738991e-03],
        [-1.18473356e-01],
        [-9.66875140e-04],
        [-4.28343285e-03],
        [-3.71602329e-02],
        [-8.10268545e-04],
        [-2.94248069e-04],
        [-2.65456530e-04],
        [-1.01866285e-03],
        [-2.81614256e-02],
        [-1.42683928e-02],
        [-2.58074116e-03],
        [-7.13682077e-02],
        [-3.61563426e-02],
        [-1.96640000e-06],
        [-3.90396482e-05],
        [-1.92547684e-05],
        [-1.50675227e-03],
        [-4.13036311e-02],
        [-2.09262322e-02],
        [-3.79755641e-03],
        [-1.04672823e-01],
        [-5.30289519e-02],
        [-1.45246242e-05],
        [-5.55811549e-05],
        [-2.76113094e-05],
        [-1.70921654e-05],
        [-4.08358502e-04],
        [-2.08294922e-04],
        [-3.97023325e-05],
        [-1.03459954e-03],
        [-5.24518085e-04],
        [-2.18273812e-06],
        [-7.17532844e-07],
        [-2.92797021e-07],
        [-1.22074825e-03],
        [-3.45514485e-02],
        [-4.68866044e-02],
        [-3.09402230e-03],
        [-8.55414071e-02],
        [-5.21413638e-02],
        [-2.93023413e-05],
        [-4.53875241e-04],
        [-1.84464412e-04],
        [-1.79439560e-03],
        [-5.01235291e-02],
        [-5.51586428e-02],
        [-4.52633232e-03],
        [-1.24968147e-01],
        [-7.22725892e-02],
        [-2.70749465e-05],
        [-2.44283645e-04],
        [-1.32013401e-04],
        [-2.02828415e-05],
        [-1.38096103e-03],
        [-2.93775538e-02],
        [-4.76589378e-05],
        [-1.51174593e-03],
        [-9.42872578e-03],
        [-3.14626116e-06],
        [-1.56943790e-05],
        [-5.27334259e-05],
        [-6.16929640e-04],
        [-2.06445976e-02],
        [-1.26429383e-01],
        [-1.56243078e-03],
        [-4.42787658e-02],
        [-5.74711985e-02],
        [-2.33338971e-06],
        [-4.36448190e-05],
        [-2.12476855e-04],
        [-9.17683116e-04],
        [-2.86381883e-02],
        [-1.31921681e-01],
        [-2.30369846e-03],
        [-6.44351026e-02],
        [-6.81199561e-02],
        [-1.46101013e-05],
        [-4.60953511e-05],
        [-2.17810367e-04],
        [-1.14595526e-05],
        [-3.75956349e-03],
        [-1.14981197e-01],
        [-2.50731250e-05],
        [-1.68766734e-03],
        [-3.50220260e-02],
        [-2.28614353e-06],
        [-6.81639226e-06],
        [-1.92367509e-04],
        [-5.65385855e-03],
        [-9.67927426e-02],
        [-4.87783652e-02],
        [-1.10377689e-02],
        [-2.45253274e-01],
        [-1.23633381e-01],
        [-2.16022665e-03],
        [-3.00626559e-03],
        [-8.27667950e-04],
        [-5.96745804e-02],
        [-1.43673045e-01],
        [-7.12804483e-02],
        [-6.67466444e-02],
        [-3.59809313e-01],
        [-1.80639418e-01],
        [-5.05533708e-02],
        [-3.99159225e-03],
        [-4.25845136e-04],
        [-9.46885958e-03],
        [-1.90313229e-03],
        [-7.19448618e-04],
        [-9.41744789e-03],
        [-4.07612031e-03],
        [-1.80669595e-03],
        [-8.71468740e-03],
        [-5.41662418e-04],
        [-2.61241964e-05],
        [-1.75032197e-02],
        [-2.86778842e-01],
        [-2.61287764e-01],
        [-4.25031506e-02],
        [-7.39107298e-01],
        [-3.17239160e-01],
        [-3.61907088e-02],
        [-5.12932271e-01],
        [-1.41292654e-01],
        [-6.72086761e-02],
        [-2.47990525e-01],
        [-2.64118285e-01],
        [-8.38363686e-02],
        [-6.23231468e-01],
        [-3.16432662e-01],
        [-6.69396289e-02],
        [-2.26098945e-01],
        [-6.17418747e-02],
        [-1.01429584e-02],
        [-1.23748708e-02],
        [-1.55824804e-01],
        [-1.07147972e-02],
        [-2.08773304e-02],
        [-5.25559751e-02],
        [-1.01090629e-02],
        [-1.73576281e-02],
        [-4.90015774e-03],
        [-4.72686643e-03],
        [-8.33353958e-02],
        [-6.51676513e-01],
        [-8.61164570e-03],
        [-1.69529355e-01],
        [-2.66539798e-01],
        [-3.32982852e-03],
        [-1.94516375e-02],
        [-6.36568260e-03],
        [-5.99005776e-02],
        [-1.09856252e-01],
        [-6.72115749e-01],
        [-6.41271814e-02],
        [-2.31382042e-01],
        [-3.00974859e-01],
        [-5.29470770e-02],
        [-1.12155571e-02],
        [-3.40987785e-03],
        [-9.81945025e-03],
        [-2.00546011e-02],
        [-6.05580038e-01],
        [-9.75203927e-03],
        [-8.77035978e-03],
        [-1.84066791e-01],
        [-9.08191769e-03],
        [-1.13102974e-03],
        [-1.18665197e-03],
        [-3.28854104e-02],
        [-9.33026658e-02],
        [-4.64416001e-02],
        [-3.75782465e-02],
        [-2.34134839e-01],
        [-1.17687234e-01],
        [-2.73967061e-02],
        [-2.37410310e-03],
        [-2.93622690e-04],
        [-7.61874317e-01],
        [-1.73296523e-01],
        [-6.80342229e-02],
        [-7.58740328e-01],
        [-3.78859295e-01],
        [-1.72399548e-01],
        [-7.00116229e-01],
        [-3.65832813e-02],
        [-1.91975636e-04],
        [-1.30680296e-01],
        [-8.06032335e-03],
        [-6.82655295e-04],
        [-1.28927185e-01],
        [-1.00162035e-02],
        [-1.71222014e-03],
        [-1.20809885e-01],
        [-6.24859784e-03],
        [-8.85605209e-06],
        [-3.78399741e-02],
        [-1.66427904e-01],
        [-2.26487863e-01],
        [-4.91552890e-02],
        [-4.15694906e-01],
        [-2.24902689e-01],
        [-3.86169732e-02],
        [-1.57879606e-01],
        [-4.33021740e-02],
        [-7.88231366e-01],
        [-2.27025613e-01],
        [-2.46238350e-01],
        [-7.88644125e-01],
        [-5.05314992e-01],
        [-2.69486569e-01],
        [-7.26783266e-01],
        [-1.05432244e-01],
        [-1.90795014e-02],
        [-1.34935782e-01],
        [-1.48902631e-02],
        [-1.54599672e-01],
        [-1.33325522e-01],
        [-1.67617823e-02],
        [-4.95970773e-02],
        [-1.24974560e-01],
        [-1.15727948e-02],
        [-1.67290629e-03],
        [-3.28126972e-02],
        [-7.78216699e-02],
        [-6.48633370e-01],
        [-3.56677578e-02],
        [-1.52716537e-01],
        [-2.59844642e-01],
        [-2.87686859e-02],
        [-7.42935626e-03],
        [-2.68601275e-03],
        [-7.88791593e-01],
        [-1.41680122e-01],
        [-6.69137063e-01],
        [-7.82393820e-01],
        [-2.53690230e-01],
        [-2.94549338e-01],
        [-7.26880074e-01],
        [-4.01007774e-02],
        [-1.80725208e-03],
        [-1.35632767e-01],
        [-2.63342699e-02],
        [-6.05004574e-01],
        [-1.33786771e-01],
        [-1.46716790e-02],
        [-1.83756753e-01],
        [-1.25414609e-01],
        [-6.68055294e-03],
        [-1.06493476e-03],
        [-7.88704703e-04],
        [-1.95121337e-02],
        [-9.89065653e-03],
        [-1.86961061e-03],
        [-4.94416263e-02],
        [-2.50478224e-02],
        [-7.81956838e-05],
        [-3.12038273e-05],
        [-1.34061382e-05],
        [-3.17111006e-03],
        [-2.87210161e-02],
        [-1.45026596e-02],
        [-4.72820200e-03],
        [-7.26155878e-02],
        [-3.67355781e-02],
        [-1.97745668e-03],
        [-1.39868750e-04],
        [-1.91674993e-05],
        [-3.78943109e-04],
        [-3.01976202e-04],
        [-1.50958168e-04],
        [-3.89469331e-04],
        [-7.35373946e-04],
        [-3.65354470e-04],
        [-3.41008654e-04],
        [-1.79807622e-05],
        [-2.16660605e-07],
        [-9.32256819e-04],
        [-2.80043448e-02],
        [-1.65034993e-01],
        [-2.22999296e-03],
        [-6.05174297e-02],
        [-7.61799080e-02],
        [-1.02079775e-04],
        [-3.63245556e-04],
        [-3.59881912e-04],
        [-3.43816804e-03],
        [-3.89431695e-02],
        [-1.72411676e-01],
        [-5.30041339e-03],
        [-8.79320643e-02],
        [-9.06178826e-02],
        [-2.04951519e-03],
        [-2.97099260e-04],
        [-3.20413163e-04],
        [-3.92909681e-04],
        [-4.92882310e-03],
        [-1.49594128e-01],
        [-4.06543231e-04],
        [-2.26174402e-03],
        [-4.55839513e-02],
        [-3.52504410e-04],
        [-3.67615719e-05],
        [-2.52998682e-04],
        [-5.14052700e-04],
        [-3.02878422e-02],
        [-6.10212903e-01],
        [-1.16754138e-03],
        [-3.55069860e-02],
        [-1.97729966e-01],
        [-8.14529696e-05],
        [-6.24894125e-05],
        [-1.02153856e-03],
        [-2.84441490e-03],
        [-3.61327903e-02],
        [-6.20517230e-01],
        [-3.77332715e-03],
        [-4.96364609e-02],
        [-2.07070224e-01],
        [-2.05236226e-03],
        [-1.64737930e-04],
        [-1.03588577e-03],
        [-3.89435933e-04],
        [-1.82072400e-02],
        [-5.89235961e-01],
        [-3.93233080e-04],
        [-5.89709436e-03],
        [-1.78236811e-01],
        [-3.53993075e-04],
        [-4.89687028e-05],
        [-9.85413505e-04],
        [-6.59238442e-03],
        [-1.20054976e-02],
        [-5.88472482e-03],
        [-7.16337480e-03],
        [-2.99557347e-02],
        [-1.49188254e-02],
        [-5.73435279e-03],
        [-7.95863576e-04],
        [-1.41626265e-04],
        [-1.58503337e-01],
        [-2.51058655e-02],
        [-8.58597372e-03],
        [-1.57239929e-01],
        [-5.10505477e-02],
        [-2.17604739e-02],
        [-1.46028887e-01],
        [-7.75075671e-03],
        [-6.98757292e-05],
        [-2.72517233e-02],
        [-1.57489907e-03],
        [-8.64394364e-05],
        [-2.68803827e-02],
        [-1.82043389e-03],
        [-2.18546903e-04],
        [-2.51975042e-02],
        [-1.31333070e-03],
        [-4.58467785e-06],
        [-8.81688553e-03],
        [-4.36456441e-02],
        [-2.04818492e-02],
        [-1.27688328e-02],
        [-1.13807862e-01],
        [-4.08846274e-02],
        [-1.18697031e-02],
        [-9.01972308e-02],
        [-2.47288254e-02],
        [-1.64465619e-01],
        [-4.14853618e-02],
        [-1.92229612e-02],
        [-1.64730523e-01],
        [-9.35514262e-02],
        [-3.69097743e-02],
        [-1.53242895e-01],
        [-4.69088018e-02],
        [-1.07807200e-02],
        [-2.81794379e-02],
        [-2.77742264e-03],
        [-5.67148756e-03],
        [-2.79052355e-02],
        [-4.57072125e-03],
        [-2.57043884e-03],
        [-2.61911117e-02],
        [-4.29877788e-03],
        [-8.22924646e-04],
        [-6.72515139e-03],
        [-9.06477998e-03],
        [-2.52860989e-02],
        [-7.14557312e-03],
        [-2.11513705e-02],
        [-1.62476551e-02],
        [-6.14315216e-03],
        [-3.68763318e-03],
        [-9.67810048e-04],
        [-1.64292995e-01],
        [-1.98115625e-02],
        [-2.70307765e-02],
        [-1.62620961e-01],
        [-3.57296690e-02],
        [-2.00493568e-02],
        [-1.51664456e-01],
        [-9.28514856e-03],
        [-4.47158849e-04],
        [-2.82874358e-02],
        [-2.23288187e-03],
        [-2.09746765e-02],
        [-2.79013952e-02],
        [-1.98218096e-03],
        [-6.47577875e-03],
        [-2.61619296e-02],
        [-1.45866944e-03],
        [-6.56436061e-05],
        [-8.59241826e-02],
        [-1.54658359e-02],
        [-5.59406400e-03],
        [-8.53439946e-02],
        [-3.23848795e-02],
        [-1.41776954e-02],
        [-7.91016625e-02],
        [-4.23440094e-03],
        [-4.83247082e-05],
        [-2.19086006e+00],
        [-1.28927151e-01],
        [-8.19575789e-03],
        [-2.16111393e+00],
        [-1.52170833e-01],
        [-2.07621247e-02],
        [-2.02556653e+00],
        [-1.04357711e-01],
        [-3.33704982e-05],
        [-3.77963549e-01],
        [-1.96177796e-02],
        [-8.25084491e-05],
        [-3.72684501e-01],
        [-1.95931770e-02],
        [-2.07134029e-04],
        [-3.49534811e-01],
        [-1.79984504e-02],
        [-2.29591959e-06],
        [-8.93010949e-02],
        [-2.67856599e-02],
        [-1.45415617e-02],
        [-8.97934230e-02],
        [-6.17215001e-02],
        [-2.50612786e-02],
        [-8.34202455e-02],
        [-3.16147332e-02],
        [-7.55051221e-03],
        [-2.26055311e+00],
        [-1.39614600e-01],
        [-1.63196907e-02],
        [-2.23044003e+00],
        [-1.73892940e-01],
        [-2.92155744e-02],
        [-2.09046707e+00],
        [-1.19524938e-01],
        [-3.30628821e-03],
        [-3.89946799e-01],
        [-2.07198647e-02],
        [-5.47804038e-03],
        [-3.84534811e-01],
        [-2.11117028e-02],
        [-2.06329506e-03],
        [-3.60657558e-01],
        [-1.94657058e-02],
        [-2.57948625e-04],
        [-8.90381136e-02],
        [-1.22259248e-02],
        [-2.48993264e-02],
        [-8.82031892e-02],
        [-2.24920412e-02],
        [-1.52788414e-02],
        [-8.21675069e-02],
        [-5.26420602e-03],
        [-3.23119186e-04],
        [-2.27392323e+00],
        [-1.27622303e-01],
        [-2.66943813e-02],
        [-2.24267185e+00],
        [-1.40762494e-01],
        [-1.92176473e-02],
        [-2.10261399e+00],
        [-1.08698362e-01],
        [-1.70895763e-04],
        [-3.92333810e-01],
        [-2.09430258e-02],
        [-2.09484462e-02],
        [-3.86851230e-01],
        [-2.03812838e-02],
        [-6.44687435e-03],
        [-3.62827834e-01],
        [-1.87126054e-02],
        [-4.51927134e-05],
        [-3.26294369e-04],
        [-2.36067775e-03],
        [-1.18991047e-03],
        [-4.53174149e-04],
        [-5.96331690e-03],
        [-3.01493025e-03],
        [-2.23373504e-04],
        [-1.48656613e-05],
        [-1.63942185e-06],
        [-6.30676167e-03],
        [-3.76227163e-03],
        [-1.74507714e-03],
        [-6.41129847e-03],
        [-9.04181589e-03],
        [-4.42183260e-03],
        [-5.71750323e-03],
        [-2.98950322e-04],
        [-2.33080844e-06],
        [-1.06805061e-03],
        [-8.89639198e-05],
        [-1.75125348e-05],
        [-1.05501271e-03],
        [-1.40413277e-04],
        [-4.37825127e-05],
        [-9.86595170e-04],
        [-5.08424046e-05],
        [-2.81245054e-08],
        [-3.51268205e-04],
        [-2.98691434e-03],
        [-6.71697126e-03],
        [-5.04794192e-04],
        [-7.19077504e-03],
        [-5.20076875e-03],
        [-2.34188602e-04],
        [-7.20489018e-05],
        [-2.61784599e-05],
        [-6.52659463e-03],
        [-4.59778100e-03],
        [-7.44050157e-03],
        [-6.66552681e-03],
        [-1.07787090e-02],
        [-6.88692805e-03],
        [-5.90011395e-03],
        [-3.33758882e-04],
        [-1.84295783e-05],
        [-1.10209415e-03],
        [-2.55682914e-04],
        [-5.18503546e-03],
        [-1.08900624e-03],
        [-2.07823581e-04],
        [-1.61289536e-03],
        [-1.01794449e-03],
        [-5.45656746e-05],
        [-9.17478486e-06],
        [-3.01998702e-04],
        [-2.07285020e-03],
        [-2.16034133e-02],
        [-3.77356905e-04],
        [-3.80778858e-03],
        [-8.13461009e-03],
        [-2.31938881e-04],
        [-1.69651123e-05],
        [-3.64435778e-05],
        [-6.49269710e-03],
        [-3.06083421e-03],
        [-2.21989194e-02],
        [-6.51850527e-03],
        [-5.80231567e-03],
        [-9.06401290e-03],
        [-5.93489370e-03],
        [-3.10231795e-04],
        [-3.70027561e-05],
        [-1.10814922e-03],
        [-7.00301267e-04],
        [-2.03726271e-02],
        [-1.09378813e-03],
        [-2.96601645e-04],
        [-6.17908587e-03],
        [-1.02411386e-03],
        [-5.38568035e-05],
        [-3.40853927e-05],
    ])

    print(grids)
    print(obj_fun(grids))
    print(np.abs(obj_fun(grids) - truths_grids) < TEST_EPSILON)
    assert np.all(np.abs(obj_fun(grids) - truths_grids) < TEST_EPSILON)

def test_name():
    obj_fun = class_fun()
    assert obj_fun.name == str_name

    assert obj_fun.__class__.__name__.lower() == str_name
    assert obj_fun.__class__.__qualname__.lower() == str_name
