<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Magic-Folder Development &mdash; Magic-Folder 1.x documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=05353d0c" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=16df9e97"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Local HTTP Interface" href="interface.html" />
    <link rel="prev" title="Statement on Backdoors" href="backdoors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Magic-Folder
          </a>
              <div class="version">
                1.x
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using Magic Folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="invites.html">How invites work</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Known Issues and Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases of Magic Folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="backdoors.html">Statement on Backdoors</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Magic-Folder Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#process-overview">Process Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filing-issues">Filing Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proposing-changes">Proposing Changes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#news-fragments">News Fragments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#backwards-incompatible-changes">Backwards Incompatible Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependency-installation-changes">Dependency/Installation Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-changes">Configuration Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removed-features">Removed Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-changes">Other Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#misc-other">Misc/Other</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reviewing-changes">Reviewing Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merging-changes">Merging Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Local HTTP Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="snapshots.html">Snapshots Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="datamodel.html">Magic Folder Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloader.html">Downloader Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-process.html">Magic-Folder Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-process.html#making-a-release">Making a Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="leif-design.html">The Leif Design: synchronization model</a></li>
<li class="toctree-l1"><a class="reference internal" href="proposed/index.html">Proposed Specifications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Magic-Folder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Magic-Folder Development</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/development.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="magic-folder-development">
<span id="id1"></span><h1>Magic-Folder Development<a class="headerlink" href="#magic-folder-development" title="Link to this heading"></a></h1>
<section id="process-overview">
<h2>Process Overview<a class="headerlink" href="#process-overview" title="Link to this heading"></a></h2>
<p>The high-level view of the Magic-Folder development process looks like this:</p>
<ol class="arabic simple">
<li><p>A shortcoming, defect, or new area of functionality is identified relating to the software.
For example,
perhaps files with names matching a certain pattern are never uploaded to the grid
or a developer decides to add a history browsing user experience to the software.</p></li>
<li><p><a class="reference internal" href="#an-issue-is-filed">An issue is filed</a> describing the shortcoming, defect, or new area of functionality.
The issue describes how the software will be different than it is now and why this is desirable.</p></li>
<li><p>Development work proceeds in a branch (typically created from a recent main branch revision).
Prior to this development or in parallel with it,
communication within the team helps identify and clear roadblocks early.</p></li>
<li><p>When development has progressed sufficiently,
the branch is <a class="reference internal" href="#proposed-for-review">proposed for review</a>.</p></li>
<li><p>One or more other developers <a class="reference internal" href="#review-the-changes">review the changes</a>.</p></li>
<li><p>The previous two steps may repeat a number of times until the changes pass review.</p></li>
<li><p>Upon passing review,
the changes are <a class="reference internal" href="#merged-into-the-main-branch">merged into the main branch</a>.</p></li>
</ol>
</section>
<section id="filing-issues">
<span id="an-issue-is-filed"></span><h2>Filing Issues<a class="headerlink" href="#filing-issues" title="Link to this heading"></a></h2>
<p>The project uses <a class="reference external" href="https://github.com/leastauthority/magic-folder/issues">GitHub issues</a> for issue tracking.</p>
</section>
<section id="proposing-changes">
<span id="proposed-for-review"></span><h2>Proposing Changes<a class="headerlink" href="#proposing-changes" title="Link to this heading"></a></h2>
<p>To propose a change,
create a <a class="reference external" href="https://github.com/leastauthority/magic-folder/pulls">GitHub Pull Request</a> against main.</p>
<p>Changes should:</p>
<ul class="simple">
<li><p>have a corresponding ticket.</p></li>
<li><p>be in a branch named <code class="docutils literal notranslate"><span class="pre">&lt;ticket</span> <span class="pre">number&gt;.&lt;some</span> <span class="pre">short</span> <span class="pre">descriptive</span> <span class="pre">text&gt;</span></code>.</p></li>
<li><p>have appropriate developer-facing and user-facing documentation.</p></li>
<li><p>have full line and branch coverage provided by the test suite.</p></li>
<li><p>be implemented in a way that is not unnecessarily difficult to understand and maintain.</p></li>
<li><p>satisfy all of the mechanical checks performed by the continuous integration system.</p></li>
</ul>
<section id="news-fragments">
<h3>News Fragments<a class="headerlink" href="#news-fragments" title="Link to this heading"></a></h3>
<p>One of the mechanical checks performed by continuous integration against proposed changes is the existence of a “news fragment”.
News fragments are assembled at release time by <a class="reference external" href="https://pypi.org/project/towncrier/">towncrier</a> to contribute to the release announcement.
News fragments are meant to be user-facing and should have a consistent style.
News fragments can use any inline formatting directives from reStructuredText.</p>
<p>magic-folder’s news fragment style is adapted from <a class="reference external" href="https://twistedmatrix.com/trac/wiki/ReviewProcess#Newsfiles">the style guidelines from the Twisted project</a>.
The fragment types accepted are canonically defined by the towncrier configuration file in the project root.</p>
<p>Here are a few guidelines which should help you write good news fragments:</p>
<ul class="simple">
<li><p>The entry SHOULD contain a high-level description of the change suitable for end users.</p></li>
<li><p>When the changes touch Python code,
the grammatical subject of the sentence SHOULD be a Python class/method/function/interface/variable/etc,
and the verb SHOULD be something that the object does.
The verb MAY be prefixed with “now”.</p></li>
<li><p>When the changes touch user interface,
the grammatical subject of the sentence SHOULD identify the part of the user interface affected
and the verb SHOULD be something that the user interface does.</p></li>
<li><p>For bugfix,
it MAY contain a reference to the version in which the bug was introduced.</p></li>
</ul>
<p>Fragment files MUST be placed in <code class="docutils literal notranslate"><span class="pre">newsfragments</span></code> and be named <code class="docutils literal notranslate"><span class="pre">&lt;ticket</span> <span class="pre">number&gt;.&lt;fragment</span> <span class="pre">type&gt;</span></code>.
You can preview the generated news content using <code class="docutils literal notranslate"><span class="pre">tox</span> <span class="pre">-e</span> <span class="pre">draftnews</span></code>.</p>
<section id="backwards-incompatible-changes">
<h4>Backwards Incompatible Changes<a class="headerlink" href="#backwards-incompatible-changes" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">incompat</span></code>.
Here are some examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``magic-folder create`` now requires the ``--path`` option.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Files in a Magic Folder with a name beginning with ``.`` are now uploaded instead of ignored.
</pre></div>
</div>
</section>
<section id="features">
<h4>Features<a class="headerlink" href="#features" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">feature</span></code>.
Here are some examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">downloader</span> <span class="n">can</span> <span class="n">now</span> <span class="n">detect</span> <span class="n">three</span><span class="o">-</span><span class="n">party</span> <span class="n">conflicts</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">On</span> <span class="n">Windows</span><span class="p">,</span> <span class="n">the</span> <span class="n">uploader</span> <span class="n">now</span> <span class="n">notices</span> <span class="n">file</span> <span class="n">changes</span> <span class="n">immediately</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">after</span> <span class="n">a</span> <span class="n">several</span> <span class="n">minute</span> <span class="n">delay</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="bug-fixes">
<h4>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">bugfix</span></code>.
Here are some examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">uploader</span> <span class="n">no</span> <span class="n">longer</span> <span class="n">fails</span> <span class="n">to</span> <span class="n">upload</span> <span class="nb">all</span> <span class="n">files</span> <span class="k">with</span> <span class="n">a</span> <span class="n">space</span> <span class="ow">in</span> <span class="n">their</span> <span class="n">name</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">downloader</span> <span class="n">now</span> <span class="n">writes</span> <span class="nb">all</span> <span class="n">files</span> <span class="n">beneath</span> <span class="n">the</span> <span class="n">Magic</span> <span class="n">Folder</span> <span class="n">directory</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span><span class="s1">&#39;s home directory.</span>
</pre></div>
</div>
</section>
<section id="dependency-installation-changes">
<h4>Dependency/Installation Changes<a class="headerlink" href="#dependency-installation-changes" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">installation</span></code>.
Here are some examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">magic</span><span class="o">-</span><span class="n">folder</span> <span class="n">now</span> <span class="n">requires</span> <span class="n">Python</span> <span class="mf">3.8</span> <span class="ow">or</span> <span class="n">newer</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">magic</span><span class="o">-</span><span class="n">folder</span> <span class="n">now</span> <span class="n">requires</span> <span class="n">pynacl</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="configuration-changes">
<h4>Configuration Changes<a class="headerlink" href="#configuration-changes" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">configuration</span></code>.</p>
</section>
<section id="removed-features">
<h4>Removed Features<a class="headerlink" href="#removed-features" title="Link to this heading"></a></h4>
<p>These are changes which deprecate or remove a feature.
The fragment type is <code class="docutils literal notranslate"><span class="pre">removed</span></code>.</p>
<p>Here are some examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>All HTTP API endpoints beneath ``/v1`` are now deprecated in favor of the ``/v2`` endpoints.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">HTTP</span> <span class="n">API</span><span class="p">,</span> <span class="n">deprecated</span> <span class="n">since</span> <span class="n">v1</span><span class="mf">.2.3</span> <span class="ow">in</span> <span class="n">favor</span> <span class="n">of</span> <span class="n">the</span> <span class="n">OTP</span> <span class="n">API</span><span class="p">,</span> <span class="n">has</span> <span class="n">been</span> <span class="n">removed</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="other-changes">
<h4>Other Changes<a class="headerlink" href="#other-changes" title="Link to this heading"></a></h4>
<p>These are changes that don’t easily fit into another category.
The fragment type is <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
</section>
<section id="misc-other">
<h4>Misc/Other<a class="headerlink" href="#misc-other" title="Link to this heading"></a></h4>
<p>The fragment type is <code class="docutils literal notranslate"><span class="pre">minor</span></code>.</p>
<p>These fragments should be empty.
Their contents will not be included in the assembled news file.</p>
</section>
</section>
</section>
<section id="reviewing-changes">
<span id="review-the-changes"></span><h2>Reviewing Changes<a class="headerlink" href="#reviewing-changes" title="Link to this heading"></a></h2>
<p>First and foremost,
the reviewer’s job is to ensure the objective of the corresponding ticket has been satisfied.</p>
<p>Some specific areas to which a reviewer can pay attention:</p>
<ul class="simple">
<li><p>Is the implementation unnecessarily difficult for a human reader to understand
(and maintain)?</p></li>
<li><p>Does the test suite make correct assertions about the behavior of the code under test?</p></li>
<li><p>Does the documentation (developer- and user-facing) accurately describe the new behavior?</p></li>
</ul>
<p>Beyond these areas there are a number of mechanical checks applied by the continuous integration system.
Changes should only be accepted if all of these mechanical checks pass
<em>or</em> if there are failures which are certainly unrelated to the changes and for which tickets have been filed.</p>
</section>
<section id="merging-changes">
<span id="merged-into-the-main-branch"></span><h2>Merging Changes<a class="headerlink" href="#merging-changes" title="Link to this heading"></a></h2>
<p>Use the GitHub merge button to merge changes to main.
Merge changes if they pass the mechanical continuous integration checks and the softer reviewer guidelines above.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="backdoors.html" class="btn btn-neutral float-left" title="Statement on Backdoors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="interface.html" class="btn btn-neutral float-right" title="Local HTTP Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright The Tahoe-LAFS Developers, The Magic-Folder Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>