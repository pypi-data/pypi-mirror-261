[tox]
min_version = 4.0
requires = tox-extras
envlist = lintinstall,lintonly

[testenv]
basepython = python3

[testenv:lintinstall]
# this testenv shows the "standard way" to do things without tox-extras
extras = lint
commands =
    black --check src
    # both our package and the linter are installed
    # note that we remove the current directory (first entry) from sys.path
    # this is because even if we don't install our package, it is still
    # on sys.path because we're running tox from its root directory
    # what we really want to know is if it is in site-packages or not
    python -c "from importlib.util import find_spec; \
        assert find_spec('example_pkg') is not None; \
        assert find_spec('black') is not None;"

[testenv:lintonly]
# this testenv shows what tox-extras enables:
# you can combine tox_extras with skip_sdist and skip_install
skip_sdist = true
skip_install = true
tox_extras = lint
commands =
    black --check src
    # our package is not installed but the linter is!
    python -c "from importlib.util import find_spec; \
        assert find_spec('example_pkg') is None; \
        assert find_spec('black') is not None;"
