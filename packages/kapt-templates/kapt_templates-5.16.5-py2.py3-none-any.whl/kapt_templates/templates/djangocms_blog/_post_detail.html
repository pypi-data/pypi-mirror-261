{% extends "djangocms_blog/base.html" %}
{% load i18n %}
{% load easy_thumbnails_tags %}
{% load cms_tags %}
{% load menu_tags %}


{% block title_tag %}{{ meta.title }}{% endblock title_tag %}

{% block seo_meta_tags %}
  {% include "djangocms_blog/partials/seo_meta_tags.html" %}
{% endblock seo_meta_tags %}

{% block cms_title %}
  {% if not post.publish %}<span class="badge text-bg-primary">{% trans "Unpublished" %}</span>{% endif %}
  <h1>
    {% render_model post "title" %}
    {% if post.subtitle %}
      <span class="subtitle">{% render_model post "subtitle" %}</span>
    {% endif %}
  </h1>
{% endblock cms_title %}

{% block cms_breadcrumb %}
  <nav>
    <ol class="breadcrumb">
      {% show_breadcrumb 0 "menu/breadcrumb_djangocms_blog.html" 0 %}
    </ol>
  </nav>
{% endblock cms_breadcrumb %}

{% block content_blog %}
  <article id="post-{{ post.slug }}" class="post-item post-detail" itemscope itemtype="{% block html_itemtype %}http://schema.org/Article{% endblock html_itemtype %}">
    <header>
      <h2>{% render_model post "title" %}</h2>
      {% block blog_meta %}
        {% include "djangocms_blog/includes/blog_meta.html" %}
      {% endblock %}
    </header>
    {% if not post.main_image_id %}
      <div class="blog-visual">{% render_placeholder post.media %}</div>
    {% else %}
      <div class="blog-visual">
        {% thumbnail post.main_image post.full_image_options.size crop=post.full_image_options.crop upscale=post.full_image_options.upscale subject_location=post.main_image.subject_location  as thumb %}
        <img src="{{ thumb.url }}" alt="{{ post.main_image.default_alt_text }}" width="{{ thumb.width }}" height="{{ thumb.height }}" loading="lazy" />
      </div>
    {% endif %}

    {% if post.app_config.use_placeholder %}
      <div class="blog-content">{% render_placeholder post.content %}</div>
    {% else %}
      <div class="blog-content">{% render_model post "post_text" "post_text" "" "safe" %}</div>
    {% endif %}

    {% if view.liveblog_enabled %}
      {% include "liveblog/includes/post_detail.html" %}
    {% endif %}

    {% if post.related.exists %}
      <section class="post-detail-list">
        {% for related in post.related.all %}
          {% include "djangocms_blog/includes/blog_item.html" with post=related image="true" TRUNCWORDS_COUNT=TRUNCWORDS_COUNT %}
        {% endfor %}
      </section>
    {% endif %}
  </article>
{% endblock content_blog %}
