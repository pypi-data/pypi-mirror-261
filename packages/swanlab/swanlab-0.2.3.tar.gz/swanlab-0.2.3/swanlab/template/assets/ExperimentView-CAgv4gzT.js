import{_ as e,L as t,u as a,M as s,i as n,A as i,N as r,o as l,a as o,b as d,t as m,d as c,e as p,r as u,f as x,F as v,s as h,w as f,G as g,h as b,m as _,C as y,c as w,q as I,O as S,P as $,g as E,Q as k,T as L}from"./index-B4yUEfBb.js";import{_ as R,D as j,a as C}from"./SLStatusLabel-Ctlg3e7s.js";import"./SLLoading-CaAXKmBy.js";const F={class:"w-full h-full py-5"},N={class:"px-6 border-b"},T={class:"experiment-title transition-marging duration-300"},D={class:"flex items-center gap-3"},M={class:"text-2xl items-center gap-1 truncate max-w-sm sm:max-w-lg 2xl:max-w-5xl"},P={class:"font-semibold"},q={class:"flex justify-end grow transition-padding duration-300 ml-1"},A={key:0,class:"experiment-description"},B={class:"experiment-navs"},G=e({__name:"ExperimentLayout",setup(e){const w=t(),I=a(),S=s(),$=n(S.experiment),E=()=>{b.delete(`/experiment/${S.id}`).then((({data:e})=>{I.deleteExperiment(e.experiment_id),w.replace("/").then((()=>{_.success("Delete Successfully")}))})).catch((({data:e})=>{_.error(e.message)}))},k=async(e,t)=>{const a=S.id,{data:s}=await b.patch(`/experiment/${a}`,e);S.setExperimentPartial(s),I.setExperimentInfo(a,e),t()},L=[{label:i("experiment.navs.index"),to:`/experiment/${S.id}/index`,icon:"experiment"},{label:i("experiment.navs.chart"),to:`/experiment/${S.id}/chart`,icon:"chart"},{label:i("experiment.navs.log"),to:`/experiment/${S.id}/log`,icon:"logs"},{label:i("experiment.navs.env"),to:`/experiment/${S.id}/env`,icon:"info"}];return(e,t)=>{const a=C,s=y,n=r("RouterLink");return l(),o("div",F,[d("div",N,[d("div",T,[d("div",D,[d("h1",M,[d("span",P,m(c(S).name),1)]),p(R,{type:"experiment",onModify:k,disabled:c(S).isRunning},null,8,["disabled"]),p(a,{name:$.value.name,id:$.value.id,status:$.value.status},null,8,["name","id","status"]),c(S).isRunning?u(e.$slots,"stop-button",{key:0},void 0,!0):x("",!0)]),d("div",q,[p(j,{type:"experiment",onConfirm:E})])]),c(S).description?(l(),o("p",A,m(c(S).description),1)):x("",!0),d("nav",B,[(l(),o(v,null,h(L,(e=>p(n,{class:"nav-item","active-class":"nav-active","data-text":e.label,key:e.to,to:e.to},{default:f((()=>[p(s,{icon:e.icon,class:"w-5 h-5"},null,8,["icon"]),g(" "+m(e.label),1)])),_:2},1032,["data-text","to"]))),64))])]),u(e.$slots,"default",{},void 0,!0)])}}},[["__scopeId","data-v-803c5e50"]]),O={__name:"StopButton",setup(e){const t=s(),n=t.id,r=t.status,d=w((()=>0===r)),m=()=>{S(i("experiment.index.header.stop.modal.title"),i("experiment.index.header.stop.modal.text"),i("experiment.index.header.stop.button")).then(c)},c=async()=>{const{data:e}=await b.get(`/experiment/${n}/stop`);e&&(t.setStatus(e.status),t.setFinishTime(e.finish_time),a().setExperimentStatus(n,-1,e.finish_time),_.success("State changed"))};return(e,t)=>(l(),o("button",{class:I(["underline text-dimmest ml-2",d.value?"":"cursor-not-allowed"]),onClick:m}," is over? ",2))}},Q={__name:"ExperimentView",setup(e){const t=L(),i=s(),d=a(),m=w((()=>void 0!==i.id)),u=n(0),h=async(e=t.params.experimentId)=>{i.experiment=void 0,i.charts=void 0,b.get(`/experiment/${e}`).then((({data:e})=>{i.experiment=e,d.setExperimentStatus(e.id,e.status,e.finish_time),i.isRunning&&_()})).catch((e=>{var t;u.value=(null==(t=e.data)?void 0:t.code)||3e3}))};h(),$(((e,t)=>{e.params.experimentId!==t.params.experimentId&&(h(e.params.experimentId),clearInterval(g))}));let g=null;const _=()=>{g=setInterval((()=>{b.get(`/experiment/${i.id}/status`).then((({data:e})=>{Number(i.id)===Number(t.params.experimentId)?(i.setStatus(e.status),i.setFinishTime(e.finish_time),d.setExperimentStatus(i.id,e.status,e.finish_time),i.charts=e.charts,i.isRunning||clearInterval(g)):clearInterval(g)})).catch((e=>{clearInterval(g)}))}),1e3)};return(e,t)=>{const a=r("router-view");return l(),o(v,null,[m.value?(l(),E(G,{key:c(i).id},{"stop-button":f((()=>[p(O)])),default:f((()=>[p(a)])),_:1})):x("",!0),!m.value&&u.value?(l(),E(k,{key:1,code:u.value},null,8,["code"])):x("",!0)],64)}}};export{Q as default};
