import{_ as e,D as t,a}from"./SLStatusLabel-Ctlg3e7s.js";import{_ as l,u as s,c as o,o as r,a as n,b as u,t as i,d as c,e as d,f as v,r as p,h as m,m as f,g as h,w as y,n as b,R as x,i as w,j as g,k,l as _,p as $,q as j,F as E,s as L,v as S,x as B,y as T,z as A,A as M,B as C,S as I,C as H,D as R,E as z,G as U,H as W,I as q,J as D}from"./index-B4yUEfBb.js";import"./SLLoading-CaAXKmBy.js";const G={class:"w-full h-full pt-5 flex flex-col"},N={class:"px-6 border-b flex-shrink-0"},O={class:"project-title transition-marging duration-300"},P={class:"flex items-center gap-3"},X={class:"text-2xl items-center gap-1 font-semibold max-w-md truncate"},F={class:"flex justify-end grow transition-padding duration-300 ml-1"},J={key:0,class:"project-description"},V=l({__name:"HomeLayout",setup(a){const l=s(),h=async(e,t)=>{const{data:a}=await m.patch("/project/update",e);l.updateInfo(a.updates),t()},y=o((()=>{for(const e of l.experiments)if(0===e.status)return!0;return!1})),b=()=>{m.delete("/project").then((()=>{f.success("Delete Successfully"),location.reload()})).catch((()=>{f.error("Error deleting project")}))};return(a,s)=>{const o=e,m=t;return r(),n("div",G,[u("div",N,[u("div",O,[u("div",P,[u("h1",X,i(c(l).name),1),d(o,{type:"project",onModify:h})]),u("div",F,[d(m,{type:"project",onConfirm:b,disabled:y.value},null,8,["disabled"])])]),c(l).description?(r(),n("p",J,i(c(l).description),1)):v("",!0),p(a.$slots,"top",{},void 0,!0)]),p(a.$slots,"default",{},void 0,!0)])}}},[["__scopeId","data-v-81eb6dd1"]]),K=["title"],Q={__name:"ExperimentName",props:{name:{type:String,required:!0},color:{type:String,required:!0},id:{required:!0}},setup:e=>(t,a)=>(r(),h(c(x),{class:"flex gap-2 items-center w-full",to:`/experiment/${e.id}`},{default:y((()=>[u("circle",{class:"w-3 h-3 rounded-full flex-shrink-0",style:b({backgroundColor:t.$props.color})},null,4),u("p",{class:"truncate",title:e.name},i(e.name),9,K)])),_:1},8,["to"]))},Y={class:"border-y flex bg-higher table-header"},Z=["onMouseover"],ee=["title"],te=["onMousedown"],ae=["title","onMouseover"],le={key:0,class:"w-full overflow-hidden"},se={key:1,class:"w-full overflow-hidden"},oe={key:0,class:"flex justify-center py-3 border border-t-0"},re={class:"data-empty"},ne=l({__name:"ExprTable",props:{data:{type:Array,default:()=>[]},column:{type:Array,default:()=>[]},maxW:{type:String,default:"none"},highLight:{type:Boolean,default:!0},flexable:{type:Boolean,default:!1},lastRowGradient:{type:Boolean,default:!1},tableBorder:{type:Boolean,default:!1},stickyHeader:{type:Boolean,default:!1}},setup(e){const t=e,a=w(null),l=w([]),s=w(null),c=w(null),d=w("100%"),m=o((()=>{if(t.flexable){const e=t.column.length;return new Array(e).fill(1/e*100+"%")}return l.value.map((e=>(null==e?void 0:e.value)?(null==e?void 0:e.value)+"px":""))})),f=w(-1),h=o((()=>-1===S.value?f.value:S.value));g((()=>{t.column.forEach(((e,t)=>{if(l.value[t]={value:0,extended:!1},e.width){const a=e.width>150?e.width:150;l.value[t].value=e.border?a-2:a}else l.value[t].value=150})),y(),window.addEventListener("resize",y)})),k((()=>{window.removeEventListener("resize",y)}));const y=()=>{var e;let t=0;l.value.forEach((({value:e})=>{t+=e})),(null==(e=c.value)?void 0:e.offsetWidth)>t?c.value.offsetWidth&&(d.value=c.value.offsetWidth):d.value=t},x=_("isSideBarShow");$(x,(e=>{t.flexable||(e?d.value-=288:d.value+=288)}));const S=w(-1),B=w(0),T=w(0),A=w(70),M=e=>{let t=T.value+(e.clientX-B.value);t=t<A.value?A.value:t,l.value[S.value].value=t,a.value[S.value]=t},C=()=>{y(),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",C),document.body.style.userSelect="auto",document.body.style.cursor="",B.value=0,T.value=0,S.value=-1},I=e=>{f.value=e};return(t,o)=>(r(),n("div",{class:"w-full",ref_key:"wrapper",ref:c},[u("div",{class:j({"gradient-last-line":e.lastRowGradient,"table-border":e.tableBorder}),style:b({width:"string"==typeof d.value?d.value:`${d.value}px`}),ref_key:"table",ref:s},[u("div",{class:j({"sticky top-0 z-20":e.stickyHeader})},[u("div",Y,[(r(!0),n(E,null,L(e.column,((t,s)=>(r(),n("div",{key:t.key,class:j(["cell table-header-item",h.value===s?"bg-highest":"bg-higher"]),onMouseover:e=>I(s),onMouseout:o[0]||(o[0]=e=>I(-1)),style:b({width:m.value[s]}),ref_for:!0,ref_key:"columnsRef",ref:a},[u("p",{class:j(["overflow-hidden w-full h-full flex items-center",t.style||"px-2 py-3"]),title:t.title},i(t.title),11,ee),e.column.unresizeable||e.flexable?v("",!0):(r(),n("button",{key:0,onMousedown:e=>((e,t)=>{document.body.style.userSelect="none",document.body.style.cursor="col-resize",S.value=t,B.value=e.clientX,m.value[t].endsWith("%")&&(l.value[t].value=a.value[t].offsetWidth),T.value=l.value[t].value,document.addEventListener("mousemove",M),document.addEventListener("mouseup",C)})(e,s),class:j({"button-hover-tip":f.value===s})},null,42,te))],46,Z)))),128))])],2),(r(!0),n(E,null,L(e.data,((a,l)=>(r(),n("div",{key:a,class:j([{"hover:bg-higher":-1===S.value},"line"])},[(r(!0),n(E,null,L(e.column,((e,s)=>(r(),n("div",{key:e.key,title:a[e.key],class:j(["cell flex items-center px-2 py-3",[e.style,{"hover:bg-primary-dimmest":-1===S.value},h.value===s?"bg-higher":"bg-default"]]),onMouseover:e=>I(s),onMouseout:o[1]||(o[1]=e=>I(-1)),style:b({width:m.value[s]})},[e.slot?(r(),n("div",le,[p(t.$slots,e.slot,{row:a,index:l},void 0,!0)])):(r(),n("div",se,i(a[e.key]||"-"),1))],46,ae)))),128))],2)))),128)),e.data.length?v("",!0):(r(),n("div",oe,[u("div",re,i(t.$t("common.table.empty")),1)]))],6)],512))}},[["__scopeId","data-v-1c6c498d"]]),ue={class:"flex-col justify-center items-center pt-10"},ie=(e=>(S("data-v-bcdae545"),e=e(),B(),e))((()=>u("div",{class:"loader"},null,-1))),ce={class:"text-center pt-10 text-lg"},de=l({__name:"EmptyTable",setup:e=>(e,t)=>(r(),n("div",ue,[ie,u("p",ce,i(e.$t("home.empty.table")),1)]))},[["__scopeId","data-v-bcdae545"]]),ve=["checked"],pe={class:"select-none truncate"},me={__name:"SLCheck",props:{label:{type:String,default:""},checked:{type:Boolean,default:!1}},emits:["update:checked"],setup:e=>(t,a)=>(r(),n("div",{class:"flex items-center gap-2 cursor-pointer",onClick:a[0]||(a[0]=a=>t.$emit("update:checked",!e.checked))},[u("input",{type:"checkbox",class:"border cursor-pointer w-4 h-4",checked:e.checked},null,8,ve),u("span",pe,i(e.label),1)]))},fe={class:"w-full flex justify-between items-center"},he={class:"flex gap-5 items-center pl-10"},ye={__name:"TableBar",props:{tableBody:{type:Array,default:()=>[]},tableHead:{type:Array,default:()=>[]},checked:{type:Boolean,default:!1},searchText:{type:String,default:""}},emits:["update:checked","update:searchText"],setup(e){const t=(e,t,a)=>{switch(t){case"config":return e.config[a]?e.config[a].value:"-";case"create_time":return C(e.create_time);case"status":return M(`experiment.status.${e.status}`);case"duration":return A(e)}};return(a,l)=>{const s=I,o=H,c=R;return r(),n("div",fe,[d(s,{class:"max-w-[400px]",onInput:l[0]||(l[0]=e=>a.$emit("update:searchText",e)),placeholder:a.$t("experiment.index.header.table-bar.placeholder")},null,8,["placeholder"]),u("div",he,[d(me,{label:a.$t("experiment.index.header.table-bar.summary"),checked:e.checked,"onUpdate:checked":l[1]||(l[1]=e=>a.$emit("update:checked",e))},null,8,["label","checked"]),d(c,{theme:"default",class:"px-3 py-2 rounded-lg flex items-center gap-2",onClick:l[2]||(l[2]=a=>function(e,a){if(!(e&&a&&Array.isArray(e)&&Array.isArray(a)&&e.length&&a.length))return;let{year:l,month:s,day:o,hour:r,minute:n,second:u}=T((new Date).getTime()-288e5);const i=`swanlab_experiments_${l}-${s}-${o}_${r}-${n}-${u}.csv`;var c="data:text/csv;charset=utf-8,\ufeff";const d=e.map((e=>e.title)).join(",");c+=d+"\n",a.forEach(((l,s)=>{let o="";for(let a=0;a<e.length;a++){const s=e[a],r=s.key||s.slot,n=s.type?t(l,s.type,r):l[r]||"-";o+=("string"==typeof n?n.replace(/,/g,"ï¼Œ"):n)+","}c+=s<a.length?o.replace(/,$/,"\n"):o.replace(/,$/,"")}));const v=document.createElement("a");v.href=encodeURI(c),v.download=i,v.click(),window.URL.revokeObjectURL(c)}(e.tableHead,e.tableBody)),hollow:""},{default:y((()=>[d(o,{icon:"download",class:"w-4 h-4"}),u("span",null,i(a.$t("experiment.index.header.table-bar.export")),1)])),_:1})])])}}},be={class:"w-80 flex flex-col gap-4 my-5 text-dimmer"},xe={class:"flex justify-between"},we={class:"grow"},ge={class:"w-36 whitespace-nowrap"},ke={class:"flex justify-between"},_e={class:"grow"},$e={class:"w-36 whitespace-nowrap"},je={class:"flex justify-between"},Ee={class:"grow"},Le={class:"w-36 whitespace-nowrap"},Se={class:"pt-5 flex flex-col flex-grow flex-shrink-0"},Be={class:"flex mx-6 mb-4 items-center gap-1.5 flex-shrink-0"},Te={class:"text-xl font-semibold"},Ae={key:0,class:"bg-highest text-default rounded-full px-3"},Me={key:0,class:"w-full pb-10 flex flex-col overflow-scroll flex-grow basis-0"},Ce={key:2},Ie=l({__name:"HomeView",setup(e){const t=s(),l=o((()=>void 0===t.experiments?[]:t.experiments)),p=w(!1);g((()=>{setTimeout((()=>{p.value=!0}),500)}));const f=o((()=>C(t.createTime))),b=o((()=>C(t.updateTime))),x=o((()=>{var e;return(null==(e=t.experiments)?void 0:e.length)||0})),k=w([{title:M("home.list.table.header.name"),slot:"name",style:"px-6",width:300,border:!0},{title:M("home.list.table.header.status"),slot:"status",type:"status"},{title:M("home.list.table.header.create"),slot:"create",type:"create_time"},{title:M("home.list.table.header.duration"),slot:"duration",type:"duration"}]),_=w([]);l.value.map((e=>{Object.entries(e.config).forEach((([e])=>{_.value.some((t=>t.title===e))||_.value.push({type:"config",slot:e,title:e})}))}));const $=o((()=>l.value.map((e=>{const t=S.value[e.name];return t?(Promise.all(Object.keys(t).map((async a=>{e[await B(a)]=isNaN(t[a])?t[a]:D(t[a])}))),e):{}})))),j=w(),S=w({});async function B(e){return"swanlab-overview-table-key"+e}m.get("/project/summaries",{params:{experiment_names:(()=>{let e=[];return l.value.forEach((t=>{e.push(t.name)})),e.join(",")})()}}).then((async({data:e})=>{j.value=await Promise.all(e.tags.map((async e=>({key:await B(e),title:e})))),S.value=e.summaries}));const T=w(!1),I=o((()=>T.value?[k.value[0],...j.value]:[...k.value,..._.value,...j.value||[]])),H=w(""),R=o((()=>H.value?$.value.filter((e=>e.name.toLowerCase().includes(H.value.toLowerCase()))):$.value));return(e,s)=>{const o=V;return r(),h(o,null,{top:y((()=>[u("div",be,[u("div",xe,[u("div",we,i(e.$t("home.overview.create")),1),u("p",ge,i(f.value),1)]),u("div",ke,[u("div",_e,i(e.$t("home.overview.latest")),1),u("p",$e,i(b.value),1)]),u("div",je,[u("div",Ee,i(e.$t("home.overview.logdir")),1),u("p",Le,i(c(t).logdir),1)])])])),default:y((()=>[u("div",Se,[u("div",Be,[u("h2",Te,i(e.$t("home.list.title")),1),x.value?(r(),n("span",Ae,i(x.value),1)):v("",!0)]),d(ye,{class:"pb-4 pt-1 px-5 flex-shrink-0","table-head":I.value,"table-body":R.value,searchText:H.value,checked:T.value,"onUpdate:checked":s[0]||(s[0]=e=>T.value=e),"onUpdate:searchText":s[1]||(s[1]=e=>H.value=e)},null,8,["table-head","table-body","searchText","checked"]),j.value&&p.value?(r(),n("div",Me,[d(ne,{"sticky-header":"",class:"dashboard-table",column:I.value,data:R.value,"last-row-gradient":""},z({name:y((({row:e})=>{return[d(Q,{name:e.name,id:e.id,color:(t=e,t.light)},null,8,["name","id","color"])];var t})),status:y((({row:e})=>[d(a,{id:e.experiment_id,status:e.status},null,8,["id","status"])])),create:y((({row:e})=>[U(i(c(W)(c(q)(e.create_time))),1)])),duration:y((({row:e})=>[U(i(c(A)(e)),1)])),_:2},[L(_.value,(e=>({name:e.slot,fn:y((({row:t})=>{var a,l;return[U(i(null!=(null==(a=t.config[e.slot])?void 0:a.value)?null==(l=t.config[e.slot])?void 0:l.value:"-"),1)]}))})))]),1032,["column","data"])])):0===l.value.length&&p.value?(r(),h(de,{key:1})):(r(),n("div",Ce,[(r(),n(E,null,L(3,(e=>u("div",{class:"w-full flex",key:e},[(r(),n(E,null,L(5,(e=>u("div",{key:e,class:"skeleton w-full py-3 m-2"}))),64))]))),64))]))])])),_:1})}}},[["__scopeId","data-v-46498c72"]]);export{Ie as default};
